<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 11:14:50" />
  <title>14.2.8  Using the Report Image and Report Table Controls </title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       AcuBench User's Guide <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="wkb14a.htm">Chapter 14: Working with Reports</a> &gt; <a href="wkb149.htm">14.2  Graphical Sample Reports</a> &gt; </p>
<a name="wp1037134"> </a><h2 class="pHeading2">
14.2.8  Using the Report Image and Report Table Controls 
</h2>
<a name="wp1037151"> </a><p class="pBody">
This sample report shows the use of a report image control and the report table, which appears in a group header.  A report table allows you to group text, variables, and images horizontally or vertically.  You can use the Skip Page properties for a report to incorporate page breaks in your report.  
</p>
<a name="wp1037177"> </a><p class="pBody">
Set up your project and work environment as described in <a  href="wkb149.htm#wp1036373">section 14.2</a>, and use the following instructions to finish creating this report.  
</p>
<a name="wp1037179"> </a><h3 class="pHeadingRef">
Create and refine the data set that corresponds to your data layout:
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1037180"> </a><div class="pSmartList1"><li>Create a new blank program called Report1f from the File/New/Program interface.  </li></div>
<a name="wp1037181"> </a><div class="pSmartList1"><li>Set up the <span style="font-family: Arial, Verdana, Helvetica, sans-serif">SalesdataDS data set for this program, as you have with previous sample reports.</span></li></div>
</ol></div>
<a name="wp1037182"> </a><h3 class="pHeadingRef">
Design your report in the Report Composer interface:
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1037183"> </a><div class="pSmartList1"><li>Open a new blank graphical report called Report1f from the File/New/Report interface, or right-click on the workspace report node and select <b class="cBold">New Report</b>.  </li></div>
<a name="wp1038956"> </a><div class="pSmartList1"><li>Use the procedures outlined in sample Report 1e to create a report with the same group headers, group footers, and detail section in that report.  In the primary group header (Report1f-GH-1) Property window, set the Skip Page before Print property to &quot;TRUE&quot;.  With this setting, only the report header appears on the first page of the report.  </li></div>
<a name="wp1040606"> </a><div class="pSmartList1"><li>Create a report table.</li></div>
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1040641"> </a><div class="pSmartList2"><li>Click the report table icon in the Report Component Toolbox and drag a table into the primary group header.  In the Insert Table dialog, define a table with one row and three columns.  </li></div>
<a name="wp1040766"> </a><div class="pSmartList2"><li>In the table's Property window, click the ellipsis button in the Table Setting value cell to open the Table Setting dialog.  In the Row Setting tab, increase the cell height to 0.60 inches.  </li></div>
<a name="wp1040767"> </a><div class="pSmartList2"><li>You relate individual cells to file descriptor and Working-Storage data items in the Cell Setting tab in this dialog.  In the Cell Setting tab, the Cell column contains the coordinates of a table cell, presented in the format (X, Y).  Double-click the other columns in the Cell Contents List to open the Select Variable dialog or a drop-down list of optional settings.  Cell (1, 1) should have a Type of Text, a Data entry of the literal string &quot;State:&quot;, and a Center alignment.  For cell (1, 2), enter a type of Variable, Sales-State OF Salesdata for the Data entry, a PIC of XX, and a Center alignment.  Cell (1, 3) should have a Data Image type, a Data entry of State-Jpeg-Name, PIC X(40), and an Alignment value of Unaligned.  </li></div>
<a name="wp1041332"> </a><div class="pSmartList2"><li>In its Property window, set the report table's Border Style property to &quot;No Box&quot; and the Show Grid Line property to &quot;FALSE&quot;.  </li></div>
<a name="wp1040869"> </a><div class="pSmartList2"><li>You can also create a table using the Drag and Drop window.  In this interface, select &quot;Rpt.Table&quot; in the right-hand drop-down box and then select the data items you want included in the table.  The Drag and Drop function creates a Text cell and a Variable cell for each data item selected.  The Text literal is pre-filled with the name of the variable selected.   The Variable cell displays the variable name in its Data column along with its PIC value.</li></div>
<a name="wp1040890"> </a><div class="pSmartList2"><li>The Drag and Drop function determines table dimensions from your selections.  The resulting table contains one row for each variable selected and two columns.  The first column contains Text types, which are used as row headers.  The second column contains the Variable types.  If you need more than two columns in your table, use the Add push button in the Column Content List toolbar in the Table Setting interface.  Use the settings described for the Table Setting dialog in the directions for creating a report table from the Report Component Toolbox.  </li></div>
<a name="wp1041108"> </a><div class="pSmartList2"><li>Although a report table may contain several variables, you should note that this report control can have only one Before-Print and one After-Print paragraph.  </li></div>
<a name="wp1044883"> </a><div class="pSmartList2"><li>Use a Before-Print operation to change the data image in your table.  Double-click the table to open the Add Paragraph dialog.  Click <b class="cBold">OK</b> to add the paragraph name to the Event Editor, and enter the following code:</li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
INITIALIZE STATE-JPEG-NAME.<a name="wp1041156"> </a>
EVALUATE Sales-State<a name="wp1041109"> </a>
  WHEN &quot;AL&quot;<a name="wp1041110"> </a>
    MOVE &quot;alabama.jpg&quot; TO state-jpeg-name<a name="wp1041111"> </a>
  WHEN &quot;AK&quot;<a name="wp1041112"> </a>
    MOVE &quot;alaska.jpg&quot; TO state-jpeg-name<a name="wp1041113"> </a>
    ...<a name="wp1041114"> </a>
  WHEN &quot;WY&quot;<a name="wp1041115"> </a>
    MOVE &quot;wyoming.jpg&quot; to state-jpeg-name<a name="wp1041116"> </a>
END-EVALUATE. <a name="wp1041117"> </a>
</pre></div>
</ul></div>
<a name="wp1041056"> </a><div class="pSmartList1"><li>Create a report image.  Click the report image icon in the Report Component Toolbox and drag it into the report header section of your report.  This operation opens the Open dialog.  Select the &quot;acucorp.bmp&quot; file from the project's Data folder.  In the Property window, set the Bitmap Style property to &quot;Stretch&quot;.  </li></div>
<a name="wp1041295"> </a><div class="pSmartList1"><li>Generate the program.  A report (&quot;.rpt&quot;) file and a Report Composer Section in the source (&quot;.cbl&quot;) file are created.    </li></div>
</ol></div>
<a name="wp1037188"> </a><h3 class="pHeadingRef">
Make one-time modifications to the generated code:
</h3>
<a name="wp1041280"> </a><p class="pIndented1">
Use the instructions for code modifications described for sample Report 1a.  Note that the PERFORM . . . DO-PRINT-RTN statement is automatically generated by AcuBench.  
</p>
<a name="wp1037215"> </a><h3 class="pHeadingRef">
Compile and execute the program.
</h3>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060621-AcuBench-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
