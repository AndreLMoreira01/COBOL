<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 11:14:50" />
  <title>14.2.7  Using Group Footers</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       AcuBench User's Guide <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="wkb14a.htm">Chapter 14: Working with Reports</a> &gt; <a href="wkb149.htm">14.2  Graphical Sample Reports</a> &gt; </p>
<a name="wp1037052"> </a><h2 class="pHeading2">
14.2.7  Using Group Footers
</h2>
<a name="wp1037058"> </a><p class="pBody">
This sample illustrates the use of group footers.  Group footers are useful when you want to show column totals.  Unlike group headers, group footers require some additional code.  When defined, a group footer is printed when a new group header is detected or an end-of-file condition is reached.  A group footer appears after the end of that group's detail section and before the next group header.  Note that multiple group footers display in the opposite order that corresponding group headers appear.  
</p>
<a name="wp1039866"> </a><p class="pBody">
This sample demonstrates how to prepare and use group footers to display column totals.  
</p>
<a name="wp1037082"> </a><p class="pBody">
After you set up your project and work environment as described in <a  href="wkb149.htm#wp1036373">section 14.2</a>, use the following instructions to finish creating this report.  
</p>
<a name="wp1037065"> </a><h3 class="pHeadingRef">
Create and refine the data set that corresponds to your data layout:
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1037066"> </a><div class="pSmartList1"><li>Create a new blank program called Report1e from the File/New/Program interface.  </li></div>
<a name="wp1037067"> </a><div class="pSmartList1"><li>Set up the <span style="font-family: Arial, Verdana, Helvetica, sans-serif">SalesdataDS data set for this program, as you have with previous sample reports.</span></li></div>
</ol></div>
<a name="wp1037068"> </a><h3 class="pHeadingRef">
Design your report in the Report Composer interface:
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1037069"> </a><div class="pSmartList1"><li>Open a new blank graphical report called Report1e from the File/New/Report interface, or right-click on the workspace report node and select <b class="cBold">New Report</b>.  </li></div>
<a name="wp1037093"> </a><div class="pSmartList1"><li>Use the Drag and Drop interface to drag the same four variables named in previous samples into the Report Composer window.  Rename the report labels as before.  </li></div>
<a name="wp1037094"> </a><div class="pSmartList1"><li>Add a report date time control to the page footer section, as described for the previous report.  </li></div>
<a name="wp1037095"> </a><div class="pSmartList1"><li>Create the same group headers that you did in the previous sample report and add settings for corresponding group footers.  In the Section Controller interface, select &quot;Both&quot; in the Show What field drop-down box.  Select &quot;Both&quot; in the Count Height field drop-down box.  </li></div>
<a name="wp1044112"> </a><div class="pSmartList1"><li>Click the report entry field icon in the Report Component Toolbox and drag a report entry field control into each group footer section.  </li></div>
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1040467"> </a><div class="pSmartList2"><li>Set the Title property for the report label in the group footer called &quot;Sales-Branch-No OF Salesdata&quot; to &quot;Totals for Branch:&quot;.  Set the report entry field's Value Variable to &quot;Sales-Branch-No-Save&quot; with a Value Picture of &quot;X(3)&quot;.  </li></div>
<a name="wp1040498"> </a><div class="pSmartList2"><li>Set the Title property for the report label in the group footer called &quot;Sales-State OF Salesdata&quot; to &quot;Totals for State:&quot;.  Set the report entry field's Value Variable to &quot;Sales-State-Save&quot; with a Value Picture of &quot;XX&quot;.  </li></div>
<a name="wp1039669"> </a><div class="pSmartList2"><li>Set the Border Style property for each report label to &quot;No Box&quot;.  </li></div>
<a name="wp1044115"> </a><div class="pSmartList2"><li>Set the Lines property for each footer section to &quot;0.31&quot;.  </li></div>
</ul></div>
<a name="wp1037063"> </a><div class="pSmartList1"><li>Add the code that allows the items in a group footer to display column totals.  </li></div>
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1039709"> </a><div class="pSmartList2"><li>When you want a variable value that appears in a group header to be displayed in a group footer, you need to develop code that saves this value after it is displayed in the header.  In this case, you can use an After-Print paragraph.  </li></div>
<a name="wp1039731"> </a><div class="pSmartList2"><li>Select the State entry field in the primary group header.  In its Property window Event tab, open the Add Paragraph dialog by clicking the ellipsis push button in the AfterPrint value cell.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:</li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
MOVE Sales-State to Sales-State-Save.<a name="wp1039751"> </a>
</pre></div>
<a name="wp1039800"> </a><div class="pSmartList2"><li>Select the Branch entry field in the secondary group header.  In its Property window Event tab, open the Add Paragraph dialog by clicking the ellipsis push button in the AfterPrint value cell.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:</li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
MOVE Sales-Branch-No to Sales-Branch-No-Save.<a name="wp1039775"> </a>
</pre></div>
</ul></div>
<a name="wp1037126"> </a><div class="pSmartList1"><li>Create report entry fields in the group footers to display column totals.  <span style="font-family: Arial, Verdana, Helvetica, sans-serif">Place addition operations in a Before-Print paragraph in the detail section.  Before-Print operations for the entry field move these column totals to formatted fields in your group footer.  </span></li></div>
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1040019"> </a><div class="pSmartList2"><li>Double-click the detail section separator to open the Add Paragraph dialog.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:</li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
* increment-gf-2-columns.<a name="wp1040087"> </a>
  ADD Heavy-Equipment-Sales to Total-State-Heavy-Sales.<a name="wp1040088"> </a>
  ADD Supplies-Sales to Total-State-Supplies-Sales.<a name="wp1040089"> </a>
<a name="wp1043002"> </a>
* increment-gf-1-columns.<a name="wp1040090"> </a>
  ADD Heavy-Equipment-Sales to
         Total-Branch-Heavy-Sales.<a name="wp1040091"> </a>
  ADD Supplies-Sales to Total-Branch-Supplies-Sales<a name="wp1040092"> </a>
</pre></div>
<a name="wp1040202"> </a><div class="pSmartList2"><li>Double-click the Total Branch Heavy Sales entry field to open the Add Paragraph dialog.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:  </li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
MOVE Total-Branch-Heavy-Sales to
    PR-Total-Branch-Heavy-Sales.<a name="wp1040203"> </a>
INITIALIZE Total-Branch-Heavy-Sales.<a name="wp1040179"> </a>
</pre></div>
<a name="wp1040207"> </a><div class="pSmartList2"><li>Double-click the Total Branch Supplies Sales entry field to open the Add Paragraph dialog.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:  </li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
MOVE Total-Branch-Supplies-Sales to
    PR-Total-Branch-Supplies-Sales.<a name="wp1040228"> </a>
INITIALIZE Total-Branch-Supplies-Sales.<a name="wp1040229"> </a>
</pre></div>
<a name="wp1040162"> </a><div class="pSmartList2"><li>Double-click the Total State Heavy Sales entry field to open the Add Paragraph dialog.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:  </li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
MOVE Total-State-Heavy-Sales to
    PR-Total-State-Heavy-Sales.<a name="wp1040287"> </a>
INITIALIZE Total-State-Heavy-Sales.<a name="wp1040288"> </a>
</pre></div>
<a name="wp1040282"> </a><div class="pSmartList2"><li>Double-click the Total State Supplies Sales entry field to open the Add Paragraph dialog.  Click <b class="cBold">OK</b> to add the paragraph name in the Event Editor, and enter the following code:  </li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
MOVE Total-State-Supplies-Sales to
    PR-Total-State-Supplies-Sales.<a name="wp1040356"> </a>
INITIALIZE Total-State-Supplies-Sales.<a name="wp1040398"> </a>
</pre></div>
</ul></div>
<a name="wp1040516"> </a><div class="pSmartList1"><li>Generate the program.  A report (&quot;.rpt&quot;) file and a Report Composer Section in the source (&quot;.cbl&quot;) file are created.    </li></div>
</ol></div>
<a name="wp1040021"> </a><h3 class="pHeadingRef">
Make one-time modifications to the generated code:
</h3>
<a name="wp1040428"> </a><p class="pIndented1">
Use the instructions for code modifications described for sample Report 1a.  Note that the PERFORM . . . DO-PRINT-RTN statement is automatically generated by AcuBench.  
</p>
<a name="wp1037168"> </a><h3 class="pHeadingRef">
Compile and execute the program.   
</h3>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060621-AcuBench-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
