<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 11:14:50" />
  <title>14.2.9  Using a Report Template and the N-Top Report Property</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       AcuBench User's Guide <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="wkb14a.htm">Chapter 14: Working with Reports</a> &gt; <a href="wkb149.htm">14.2  Graphical Sample Reports</a> &gt; </p>
<a name="wp1037216"> </a><h2 class="pHeading2">
14.2.9  Using a Report Template and the N-Top Report Property
</h2>
<a name="wp1037233"> </a><p class="pBody">
This sample report demonstrates how to use a report template (&quot;.wtf&quot;) file.  A &quot;.wtf&quot; file is a description of your report written in standard text file format.  You can use a report template as a baseline for creating other reports by adding or modifying the report components in the template.  Note that Event Editor code is not preserved in the &quot;.wtf&quot; file, so event code from the original report needs to be added to this report before your final code generation. 
</p>
<a name="wp1044284"> </a><p class="pBody">
A report property called &quot;N-Top&quot; allows your report to be viewed in a Web browser in a horizontal (landscape) orientation.  Because this is a display characteristic, the print and print preview functions are limited to displaying or printing only the first page of an N-Top report.  If you want to print this type of report, you need to use the print to file function to write the report to a file, then use some other method for printing/displaying the report.  
</p>
<a name="wp1044175"> </a><p class="pBody">
The Skip Page before Print and Skip Page after Print properties should not be used for an N-Top report.  Skip page properties are generally used only in a printed report.  
</p>
<a name="wp1037303"> </a><p class="pBody">
Set up your project and work environment as described in <a  href="wkb149.htm#wp1036373">section 14.2</a>, and use the following instructions to finish creating this report.  
</p>
<a name="wp1037305"> </a><h3 class="pHeadingRef">
Create and refine the data set that corresponds to your data layout:
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1037306"> </a><div class="pSmartList1"><li>Create a new blank program called Report1g from the File/New/Program interface.  </li></div>
<a name="wp1037293"> </a><div class="pSmartList1"><li>Set up the <b class="cBold">SalesdataDS</b><span style="font-family: Arial, Verdana, Helvetica, sans-serif"> data set for this program, as you have with previous sample reports.  </span></li></div>
</ol></div>
<a name="wp1037294"> </a><h3 class="pHeadingRef">
Design your report in the Report Composer interface:
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1037295"> </a><div class="pSmartList1"><li>We have supplied a report template file for you to use in this sample.  Right-click on the Report1g program node and select the Add Report command.  Navigate to &quot;Report1f.wtf&quot; in the Add Report to Program dialog (in the AcuGT/sample/reports directory) and add it to the Report1g program.  (To create a &quot;.wtf&quot; report template file, you would open the desired report in the workspace Structure view.  Right-click in the Report Composer window and select the Generate WTF Document command.  The resulting &quot;.wtf&quot; file contains the names of the controls in this report along with their Property window settings.)  </li></div>
<a name="wp1048693"> </a><div class="pSmartList1"><li>As mentioned, you need to add event code.  In the workspace Structure view, right-click the original report's Event Paragraph to open the Event Editor.  Copy the before and after print procedures associated with the report and paste them into the Event Paragraph for the new report you created with the template.  </li></div>
<a name="wp1037309"> </a><div class="pSmartList1"><li>In the report Property window, change the report (Name) property to &quot;Report1g&quot;.  Change the Output File property to &quot;Report1g.html&quot; and the Report Type property to &quot;N-Top&quot;.  </li></div>
<a name="wp1044894"> </a><div class="pSmartList1"><li>Because a template based on Report 1f has been used, you will notice that the sections and report controls in the report have names based on Report 1f.  For example, the page header section name in sample Report 1g is &quot;Report1f-PH-1&quot;.  Change these names to reflect Report 1g in the Property window for each report section and control.  </li></div>
<a name="wp1037343"> </a><div class="pSmartList1"><li>For the group header &quot;Report-GH-1&quot;, modify the Skip Page before Print property to &quot;FALSE&quot;.  </li></div>
<a name="wp1041418"> </a><div class="pSmartList1"><li>Generate the program.  A report (&quot;.rpt&quot;) file and a Report Composer Section in the source (&quot;.cbl&quot;) file are created.    </li></div>
</ol></div>
<a name="wp1037356"> </a><h3 class="pHeadingRef">
Make one-time modifications to the generated code:  
</h3>
<a name="wp1041430"> </a><p class="pIndented1">
Use the instructions for code modifications described for sample Report 1a.  Note that the PERFORM . . . DO-PRINT-RTN statement is automatically generated by AcuBench.  
</p>
<a name="wp1041518"> </a><p class="pIndented1">
Remember, if you want to print this type of report (N-Top), you need to use the PERFORM <em class="cEmphasis">reportname</em>-PRINT-TOFILE function to write the report to a file, then use some other method for printing/displaying the report.  Note that this sample report contains code that allows the display of generated HTML in the ACUCOBOL-GT Web browser control.  
</p>
<a name="wp1037357"> </a><h3 class="pHeadingRef">
Compile and execute the program.   
</h3>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060621-AcuBench-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
