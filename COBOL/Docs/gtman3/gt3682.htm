<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/14/06 08:28:08" />
  <title>CALL Statement</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       ACUCOBOL-GT Reference Manual <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="gt36.htm"><br />Chapter 6:  Procedure Division</a> &gt; <a href="gt3678.htm">6.6  Procedure Division Statements </a> &gt; </p>
<a name="wp1036903"> </a><h2 class="pHeading2">
CALL Statement
</h2>
<a name="wp1198378"> </a><p class="pBody">
The CALL statement causes control to be transferred to another program.  For a discussion of how the runtime handles program calls, see section 2.9, &quot;Calling Subprograms,&quot; in Book 1.  For information about calling subroutines in DLLs and UNIX shared libraries, see Chapters 3 and 6 of <em class="cEmphasis">A&#160;Guide to Interoperating with ACUCOBOL-GT</em>.  
</p>
<a name="wp1036907"> </a><h3 class="pHeadingRef">
General Format
</h3>
<a name="wp1036908"> </a><h3 class="pHeadingRef">
Format 1
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">CALL</u> [IN <u class="cUnderline">THREAD</u>] program-name<a name="wp1036909"> </a>
<a name="wp1036910"> </a>
 [ <u class="cUnderline">HANDLE</u> IN handle-1 ]<a name="wp1036911"> </a>
<a name="wp1036912"> </a>
 [ <u class="cUnderline">USING</u> { [ BY {<u class="cUnderline">REFERENCE</u>} ] {parameter} size-phrase ...} ...]<a name="wp1191402"> </a>
                {<u class="cUnderline">CONTENT</u>  }   {<u class="cUnderline">OMITTED</u>  }<a name="wp1191403"> </a>
                {<u class="cUnderline">VALUE</u>    }   {<u class="cUnderline">NULL</u>     }<a name="wp1191404"> </a>
<a name="wp1036916"> </a>
 [ {<u class="cUnderline">RETURNING</u>} INTO return-val ]<a name="wp1036917"> </a>
   {<u class="cUnderline">GIVING</u>   }<a name="wp1036918"> </a>
<a name="wp1036919"> </a>
 [ ON     {<u class="cUnderline">EXCEPTION</u>} statement-1 ]<a name="wp1036920"> </a>
          {<u class="cUnderline">OVERFLOW</u> }<a name="wp1036921"> </a>
<a name="wp1036922"> </a>
 [ <u class="cUnderline">NOT</u> ON {<u class="cUnderline">EXCEPTION</u>} statement-2 ]<a name="wp1036923"> </a>
          {<u class="cUnderline">OVERFLOW</u> }<a name="wp1036924"> </a>
<a name="wp1063710"> </a>
 [ <u class="cUnderline">END-CALL</u> ]<a name="wp1036925"> </a>
</pre></div>
<a name="wp1152648"> </a><p class="pBody">
where <em class="cEmphasis">size-phrase</em> is:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
[WITH MEMORY <u class="cUnderline">SIZE</u> {= } memory-size]<a name="wp1152649"> </a>
                  {IS}<a name="wp1152659"> </a>
</pre></div>
<a name="wp1036926"> </a><h3 class="pHeadingRef">
Format 2
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">CALL</u> <u class="cUnderline">RUN</u> program-name <a name="wp1036927"> </a>
<a name="wp1127223"> </a>
 [ <u class="cUnderline">USING</u> {parameter} ... ]<a name="wp1127224"> </a>
<a name="wp1036929"> </a>
 [ ON     {<u class="cUnderline">EXCEPTION</u>} statement-1 ]<a name="wp1036930"> </a>
          {<u class="cUnderline">OVERFLOW</u> }<a name="wp1036931"> </a>
<a name="wp1036932"> </a>
 [ <u class="cUnderline">NOT</u> ON {<u class="cUnderline">EXCEPTION</u>} statement-2 ]<a name="wp1036933"> </a>
          {<u class="cUnderline">OVERFLOW</u> }<a name="wp1036934"> </a>
<a name="wp1036935"> </a>
 [ <u class="cUnderline">END-CALL</u> ]<a name="wp1036936"> </a>
</pre></div>
<a name="wp1036937"> </a><h3 class="pHeadingRef">
Format 3
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">CALL</u> <u class="cUnderline">PROGRAM</u> program-name<a name="wp1036938"> </a>
<a name="wp1036939"> </a>
 [ <u class="cUnderline">USING</u> {parameter} ... ]<a name="wp1036940"> </a>
<a name="wp1036941"> </a>
 [ ON  {<u class="cUnderline">EXCEPTION</u>} statement-1 ]<a name="wp1127240"> </a>
       {<u class="cUnderline">OVERFLOW</u> }<a name="wp1127241"> </a>
<a name="wp1127242"> </a>
 [ <u class="cUnderline">END-CALL</u> ]<a name="wp1036945"> </a>
</pre></div>
<a name="wp1036947"> </a><h3 class="pHeadingRef">
Format 4  (HP COBOL)
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">CALL</u> { identifier-1            } [ <u class="cUnderline">USING</u> { \\             } ... ]<a name="wp1036948"> </a>
     { [ INTRINSIC ] literal-1 }         { @identifier-2  }<a name="wp1036949"> </a>
                                         { identifier-2   }<a name="wp1036950"> </a>
                                         { literal-2      }<a name="wp1036951"> </a>
                                         { \identifier-2\ }<a name="wp1036952"> </a>
                                         { \literal-2\    }<a name="wp1036953"> </a>
<a name="wp1155645"> </a>
     [ <u class="cUnderline">GIVING</u> identifier-3 ]<a name="wp1036954"> </a>
<a name="wp1155646"> </a>
     [ ON {<u class="cUnderline">EXCEPTION</u>} statement-1 ]<a name="wp1155649"> </a>
          {<u class="cUnderline">OVERFLOW</u> )<a name="wp1155653"> </a>
<a name="wp1155672"> </a>
     [ <u class="cUnderline">NOT</u> ON {<u class="cUnderline">EXCEPTION</u>} statement-2 ]<a name="wp1155650"> </a>
              {<u class="cUnderline">OVERFLOW</u> )<a name="wp1155669"> </a>
<a name="wp1155654"> </a>
     [ <u class="cUnderline">END-CALL</u> ] ]<a name="wp1155647"> </a>
</pre></div>
<a name="wp1036967"> </a><h3 class="pHeadingRef">
Syntax Rules
</h3>
<a name="wp1036969"> </a><p class="pNote">
<hr />
<b>Note:  </b>For Syntax Rules and General Rules specific to Format 4, see Chapter 4, &quot;HP COBOL Conversions,&quot; in <em class="cEmphasis">Transitioning to ACUCOBOL-GT</em>.
<hr />
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1036971"> </a><div class="pSmartList1"><li><em class="cEmphasis">Program-name</em> is a nonnumeric literal or an alphanumeric data item. </li></div>
<a name="wp1036972"> </a><div class="pSmartList1"><li><em class="cEmphasis">Handle-1</em> must be a USAGE HANDLE or HANDLE OF THREAD data item.</li></div>
<a name="wp1036973"> </a><div class="pSmartList1"><li>The NULL and OMITTED options are synonymous.</li></div>
<a name="wp1152660"> </a><div class="pSmartList1"><li><em class="cEmphasis">Memory-size</em> is a numeric literal or data item.</li></div>
<a name="wp1036974"> </a><div class="pSmartList1"><li><em class="cEmphasis">Parameter</em> is any non-level 88 data item or a literal.  It may be subscripted and reference modified.  It may be the SELECT name of an open COBOL file.</li></div>
<a name="wp1036975"> </a><div class="pSmartList1"><li><em class="cEmphasis">Statement-1</em> and <em class="cEmphasis">statement-2</em> are imperative statements.</li></div>
<a name="wp1036976"> </a><div class="pSmartList1"><li>EXCEPTION and OVERFLOW are equivalent.</li></div>
<a name="wp1036977"> </a><div class="pSmartList1"><li>The NOT EXCEPTION phrase may not be used when the PROGRAM option is used. </li></div>
<a name="wp1036978"> </a><div class="pSmartList1"><li><em class="cEmphasis">Return-val</em> must specify a numeric data item.</li></div>
<a name="wp1036979"> </a><div class="pSmartList1"><li>RETURNING and GIVING are synonymous.</li></div>
</ol></div>
<a name="wp1036980"> </a><h3 class="pHeadingRef">
General Rules
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1036982"> </a><div class="pSmartList1"><li><em class="cEmphasis">Program-name</em> specifies the name of the called program.  The exact procedure for resolving this name into the name of a program to call is described in Book 1,<em class="cEmphasis"> ACUCOBOL-GT User's Guide</em>, section 2.9.   </li></div>
<a name="wp1036985"> </a><div class="pSmartList1"><li>The THREAD option starts a new thread before calling the target program.  The called program executes in the new thread.  The calling program continues to execute in parallel.  When the called program exits, its thread is terminated.  </li></div>
<a name="wp1036986"> </a><div class="pSmartList1"><li>The HANDLE phrase stores the ID of the thread in <em class="cEmphasis">handle-1</em> immediately after the new thread starts.  This occurs before the USING parameters are evaluated, so that it is possible to pass <em class="cEmphasis">handle-1</em> to the called program.  </li></div>
<a name="wp1036988"> </a><div class="pSmartList1"><li>The <em class="cEmphasis">parameters</em>' order of appearance in the USING phrases of the CALL verb, and the called program's Procedure Division header, determine the correspondence between the data names used in the called and calling programs.  This correspondence is established by position, not by name.  </li></div>
<a name="wp1152999"> </a><div class="pSmartList1"><li>The SIZE phrase is used when the parameter in the USING phrase is a memory address (pointer to memory) and you need to specify the size of the piece of memory that is located at that address.  The SIZE phrase supports the calling of DLLs on the display host by thin client applications.  For complete information, see section 6.5.6, &quot;Calling Dynamic Link Libraries (DLLs),&quot; in the <em class="cEmphasis">AcuConnect User's Guide</em>. </li></div>
<a name="wp1036990"> </a><div class="pSmartList1"><li>The BY phrase controls how parameters are passed to the called program.  The default method is BY REFERENCE.  This method causes the address of the data item to be passed to the receiving program.  This is the only method of passing data available in versions of ACUCOBOL-GT prior to 2.0. </li></div>
<a name="wp1036993"> </a><p class="pIndented1">
The BY CONTENT phrase is similar to BY REFERENCE, except that the address of a copy of the data item is sent.  This has the effect that any changes made to the parameter in the called program are not seen by the caller.  Starting with Version 2.0, literals passed as parameters are automatically passed BY CONTENT.  
</p>
<a name="wp1036994"> </a><p class="pIndented1">
The BY VALUE method causes the contents of the data item to be passed to the receiving program (the actual data, not its address).  This may <em class="cEmphasis">not</em> be specified if the receiving program is a COBOL program (results are undefined in this case).  This method is typically used to pass numeric data to C subprograms.  For optimal portability we recommend that parameters being passed by this method be level 01 or 77 items described as SIGNED-INT, UNSIGNED-INT, SIGNED-SHORT, UNSIGNED-SHORT, SIGNED-LONG, UNSIGNED-LONG, or POINTER.
</p>
<a name="wp1072392"> </a><p class="pIndented1">
When the name of an open COBOL file is given as a parameter, the operating system's file handle is passed.  One possible reason for doing this is to call an operating system function that allows the file to retrieve some information that is not available through COBOL.  Several special rules apply to this usage.  See rules 30 through 35 below.
</p>
<a name="wp1036995"> </a><div class="pSmartList1"><li>The NULL and OMITTED options are synonymous.  They allow you to skip a parameter in a USING phrase.  The corresponding parameter in the called program must not be referenced.  If the called program is a C program, then a NULL value is passed to the corresponding parameter.  </li></div>
<a name="wp1192371"> </a><div class="pSmartList1"><li>Index names referred to in the Linkage Section of the called program do not correspond to any index names in the calling program.  Index data items are always stored in the local memory of their programs.  </li></div>
<a name="wp1192373"> </a><div class="pSmartList1"><li>If the called program does not have the INITIAL attribute, then it is in its initial state the first time it is called, and the first time it is called after a CANCEL verb has referred to it.  On all other calls, the program is in the same state as when it last exited.  </li></div>
<a name="wp1036999"> </a><div class="pSmartList1"><li>If the called program has the INITIAL attribute, it is in its initial state every time it is called.</li></div>
<a name="wp1037000"> </a><div class="pSmartList1"><li>Files contained in the called program are not open whenever the called program is in its initial state.  Otherwise, the status and positioning of the contained files is the same as when the program last exited.</li></div>
<a name="wp1037001"> </a><div class="pSmartList1"><li>If the ON EXCEPTION phrase is present and the called program cannot be initiated, <em class="cEmphasis">statement-1</em> executes.  If the called program cannot be initiated when there is no EXCEPTION phrase, a runtime error occurs and the program halts.  A program cannot be initiated if <em class="cEmphasis">program-name</em> cannot be resolved using the rules described in <em class="cEmphasis">ACUCOBOL-GT User's Guide</em> section 2.9, &quot;Calling Subprograms.&quot;  </li></div>
<a name="wp1037002"> </a><div class="pSmartList1"><li>If the NOT ON EXCEPTION phrase is present and the called program is successfully initiated, <em class="cEmphasis">statement-2</em> executes when the called program returns.  </li></div>
<a name="wp1037003"> </a><div class="pSmartList1"><li>The ON EXCEPTION and NOT ON EXCEPTION phrases execute in the original (parent) thread.  The parent thread suspends long enough to determine whether or not the CALL will succeed.  This allows it to determine whether to execute the EXCEPTION or NOT EXCEPTION case.  </li></div>
<a name="wp1037004"> </a><div class="pSmartList1"><li>A called program's file state and data items are distinct for each thread that exists at the time of the call (including the thread created by the CALL THREAD).  Thus, if <em class="cEmphasis">thread-1</em> calls <em class="cEmphasis">program-a</em>, and <em class="cEmphasis">thread-2</em> calls <em class="cEmphasis">program-a</em>, there will be two copies of the data from <em class="cEmphasis">program-a</em> in memory, one set for each thread.  Threads created in the called program, or any of its subprograms, share the called program's data and file state.</li></div>
<a name="wp1037006"> </a><div class="pSmartList1"><li>The CALL PROGRAM verb is similar to the CHAIN verb.  It causes the current run unit to terminate and initiates a new run unit.  However, USING parameters are passed to data items specified in Linkage, just as they are for a standard CALL verb.</li></div>
<a name="wp1037007"> </a><p class="pIndented1">
Some (incorrect) usages of the CALL statement USING parameters from the Linkage section of the called program can result in so-called &quot;intermediate&quot; runtime errors that call installed error procedures.  There currently are two such related errors:  &quot;Use of a LINKAGE data item not passed by the caller,&quot; and &quot;Passed USING item smaller than corresponding LINKAGE item.&quot;  A passed USING item that is larger than the corresponding Linkage item does not generate an error.
</p>
<a name="wp1037008"> </a><p class="pIndented1">
Another runtime error can occur when the CALL statement attempts USING parameters of invalid structure or missing parameters.  That kind of error is announced as &quot;Invalid or missing parameter,&quot; and it is also an &quot;intermediate&quot; type of runtime error that calls installed error procedures.
</p>
<a name="wp1037009"> </a><p class="pIndented1">
See Book 4 <em class="cEmphasis">Appendices</em>, Appendix I &quot;Library Routines,&quot; for detailed discussion of the runtime error and exit procedures.
</p>
<a name="wp1037010"> </a><div class="pSmartList1"><li>When a CALL PROGRAM verb succeeds, all program switches are set to their &quot;off&quot; state.  You can specify switches to be set &quot;on&quot; in the CALL PROGRAM statement.  You accomplish this by specifying the switch names immediately after the program name in the statement.  Each switch name must be alphabetic and must be preceded by a slash (/).  For example, to turn on switches &quot;A&quot; and &quot;B&quot; you could use this statement:</li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
CALL PROGRAM &quot;MYPROG/A/B&quot; USING ...<a name="wp1037011"> </a>
</pre></div>
<a name="wp1037012"> </a><div class="pSmartList1"><li>If the CALL PROGRAM verb cannot find the called program, and no EXCEPTION phrase has been specified, control passes to the next executable statement.  </li></div>
<a name="wp1037013"> </a><div class="pSmartList1"><li>The CALL PROGRAM verb accepts the presence of routines whose name begins with a &quot;#&quot; sign.  When one of these routines is specified, the CALL PROGRAM statement is ignored.  In ICOBOL, routines with these names are special-purpose system routines.  </li></div>
<a name="wp1037014"> </a><div class="pSmartList1"><li>If the RUN option is used, then <em class="cEmphasis">program-name</em> refers to the main program of another run unit.  This run unit is initiated and continues until it executes a STOP RUN.  At that point, control is returned to the next executable sentence in the calling program.  Parameters are passed to the called run unit in the same manner as specified for the CHAIN statement.  </li></div>
<a name="wp1037015"> </a><p class="pIndented1">
The called run unit is logically distinct from the calling run unit.  It may call programs that are active in the calling unit without generating an error.  External areas are associated with a logical run unit, so that a new run unit does not have access to external areas created by the calling run unit.  Take care that file records locked by the calling run unit do not interfere with the called run unit, because there will be no opportunity for the caller to release its records while the called unit is active.  
</p>
<a name="wp1037016"> </a><p class="pIndented1">
Type-ahead is retained both when the new run unit is called and upon return from it.
</p>
<a name="wp1037017"> </a><p class="pIndented1">
The precise amount of memory required for the runtime varies by platform and is affected by configuration variables such as V_BUFFERS and by any products or C routines you have linked in.  When the CALL RUN executes, the memory associated with the new run unit is allocated, and the old run unit (with its attendant memory) remains active.  Memory allocated by the runtime for program code is freed automatically at the STOP RUN in the called program.  Memory used for open windows and V_BUFFERS is not freed until the runtime exits.  You should explicitly free any memory that you allocated with the M$ALLOC library routine, otherwise this memory is not freed until the runtime exits. 
</p>
<a name="wp1037022"> </a><div class="pSmartList1"><li>A special register named RETURN-CODE is automatically created by the compiler and is shared by all programs of a run unit.   This special register is defined as: </li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
77  RETURN-CODE  SIGNED-LONG, EXTERNAL.<a name="wp1037024"> </a>
</pre></div>
<a name="wp1037025"> </a><p class="pIndented1">
If you call a C program via the &quot;direct&quot; interface, the return value of the C function is placed into this register.  If you call the SYSTEM library routine, the status of the call is placed into this register.  The verbs EXIT, STOP, and GOBACK can also place a value into the RETURN-CODE register. 
</p>
<a name="wp1037027"> </a><p class="pIndented1">
The compiler also creates an unsigned version of the return code called RETURN-UNSIGNED.  It has the following implied definition:  
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
77  RETURN-UNSIGNED<a name="wp1037028"> </a>
    REDEFINES RETURN-CODE <a name="wp1037029"> </a>
    UNSIGNED-LONG, EXTERNAL.<a name="wp1037030"> </a>
</pre></div>
<a name="wp1037032"> </a><div class="pSmartList1"><li>If the RETURNING phrase is used, then the &quot;return value&quot; of the called program is moved to <em class="cEmphasis">return-val</em>.  This is accomplished by the following rule:</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp1037033"> </a><div class="pSmartList2"><li>If <em class="cEmphasis">return-val</em> is a signed data item, then the value of RETURN-CODE is moved to <em class="cEmphasis">return-val</em> according to the rules of the MOVE statement.</li></div>
<a name="wp1037034"> </a><div class="pSmartList2"><li>If <em class="cEmphasis">return-val</em> is unsigned, then RETURN-UNSIGNED is moved instead.</li></div>
</ol></div>
<a name="wp1200165"> </a><div class="pSmartList1"><li>You should avoid using RETURN-CODE or RETURN-UNSIGNED for <em class="cEmphasis">return-val</em>.  This is pointless because, after assigning a value to <em class="cEmphasis">return-val</em>, the CALL statement restores the previous value of RETURN-CODE.</li></div>
<a name="wp1037036"> </a><div class="pSmartList1"><li>On Windows systems, if you CALL a DLL, the runtime assumes that the DLL returns a &quot;long&quot; (at least 32 bits of data).  This ensures that all of the data returned from the DLL is captured.  However, in situations where the DLL returns less than 32 bits of data (such as a DLL that returns a &quot;short&quot;), some of the data might be random.  To get the right size for the return value of DLLs, use the RETURNING phrase and set the receiving variable to the same size as the DLL's return value.  The easiest way to do this is to declare the receiving variable to be the same type as the DLL's return type.  For example, if the DLL &quot;MYDLL&quot; returns an &quot;int,&quot; you could do the following: </li></div>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
77  RETURN-VAL       SIGNED-INT.<a name="wp1037038"> </a>
CALL &quot;MYDLL&quot; RETURNING RETURN-VAL.<a name="wp1037039"> </a>
</pre></div>
<a name="wp1037040"> </a><div class="pSmartList1"><li>After <em class="cEmphasis">return-val</em> is set, RETURN-CODE is set to the value it had immediately prior to the CALL statement.  Thus the called program does not affect the value of RETURN-CODE in the calling program.  </li></div>
<a name="wp1037041"> </a><div class="pSmartList1"><li>If the CALL statement fails with an exception, then <em class="cEmphasis">return-val</em> is not updated.</li></div>
<a name="wp1037045"> </a><div class="pSmartList1"><li>You may pass floating-point data to subroutines normally with the CALL verb.  Note that you may not pass a floating-point item BY VALUE.  This restriction exists for portability reasons (some machines pass floating-point using a convention different from that used for integer items).  You should pass floating-point items BY REFERENCE.  This will pass a pointer to the item, which the receiving routine can then retrieve by &quot;de-referencing&quot; the pointer.</li></div>
<a name="wp1037046"> </a><div class="pSmartList1"><li>A program may directly or indirectly call itself.  A CALL statement that calls the active program (itself) is a <em class="cEmphasis">recursive call</em>.  For more information, see the RECURSION configuration variable in Appendix H, Book 4, <em class="cEmphasis">Appendices.</em>  For information on sharing data in recursively called programs (such as in the HP COBOL environment), see the RECURSION_DATA_GLOBAL configuration variable.  See also section 2.9 in Book 1, <em class="cEmphasis">ACUCOBOL-GT User's Guide.  </em></li></div>
<a name="wp1037047"> </a><div class="pSmartList1"><li>Errors that occur as a result of the CALL statement USING parameters from the Linkage section of the called program belong to an &quot;intermediate&quot; type of runtime errors that call installed error procedures.  There are two such errors: &quot;Use of a LINKAGE data item not passed by the caller,&quot; and &quot;Passed USING item smaller than corresponding LINKAGE item.&quot;</li></div>
</ol></div>
<a name="wp1072400"> </a><h3 class="pHeadingRef">
Passing file handles
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1073007"> </a><div class="pSmartList1"><li>For compatibility with HP COBOL, a file handle is automatically passed BY VALUE unless it is immediately preceded by a BY REFERENCE or BY CONTENT specification.  File handles passed to COBOL subroutines must be preceded with BY REFERENCE or BY CONTENT because COBOL routines cannot take BY VALUE parameters. </li></div>
<a name="wp1073008"> </a><div class="pSmartList1"><li>If the called subroutine is a COBOL routine, the handle passed is PIC S9(4) COMP-5.  You can override this with the compiler option &quot;--fileIdSize=#&quot; where &quot;#&quot; is either &quot;2&quot;, &quot;4&quot;, or &quot;8&quot; to specify the number of bytes you want in the passed integer.  </li></div>
<a name="wp1073009"> </a><div class="pSmartList1"><li>If the called subroutine is not COBOL, the handle is passed as a signed native integer using the host's default integer size.</li></div>
<a name="wp1073010"> </a><div class="pSmartList1"><li>The file handle passed is the host file system's identifying value for the open file.  For all current implementations, this is the value returned by the C &quot;open&quot; function.  If the host file system does not have this information available, then &quot;-1&quot; is used instead.  This can happen if the host system is not a file (e.g. Acu4GL for Oracle) or the host system does not provide a way of obtaining the handle (e.g. C-ISAM interface).  Files served by AcuServer® also use &quot;-1&quot; because there is no useful way to use a remote process' open file handle.  </li></div>
<a name="wp1073012"> </a><div class="pSmartList1"><li>For Vision files in the multi-file format (Version 5 and 4), the handle used is the handle of the first data segment (this is the same file used when opening the file).  </li></div>
<a name="wp1073013"> </a><div class="pSmartList1"><li>It is best to avoid performing actual I/O on the file using this file handle because the COBOL file system will be unaware of any state changes to the file and may perform incorrectly.  It is possible to corrupt data this way.  </li></div>
</ol></div>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
