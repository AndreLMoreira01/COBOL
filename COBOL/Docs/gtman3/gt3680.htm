<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/14/06 08:28:08" />
  <title>ADD Statement</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       ACUCOBOL-GT Reference Manual <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="gt36.htm"><br />Chapter 6:  Procedure Division</a> &gt; <a href="gt3678.htm">6.6  Procedure Division Statements </a> &gt; </p>
<a name="wp1061977"> </a><h2 class="pHeading2">
ADD Statement
</h2>
<a name="wp1036798"> </a><p class="pBody">
The ADD statement performs arithmetic addition. 
</p>
<a name="wp1036800"> </a><h3 class="pHeadingRef">
General Format
</h3>
<a name="wp1036801"> </a><h3 class="pHeadingRef">
Format 1
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">ADD</u> {num} ... <u class="cUnderline">TO</u> { result [<u class="cUnderline">ROUNDED</u>] } ...<a name="wp1036802"> </a>
<a name="wp1036803"> </a>
   [ ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-1 ]<a name="wp1036804"> </a>
<a name="wp1036805"> </a>
   [ <u class="cUnderline">NOT</u> ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-2 ]<a name="wp1036806"> </a>
<a name="wp1036807"> </a>
   [ <u class="cUnderline">END-ADD</u> ]<a name="wp1036808"> </a>
</pre></div>
<a name="wp1036809"> </a><h3 class="pHeadingRef">
Format 2
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">ADD</u> {num} ... <u class="cUnderline">TO</u> num <u class="cUnderline">GIVING</u> { result [<u class="cUnderline">ROUNDED</u>] } ...<a name="wp1036810"> </a>
<a name="wp1036811"> </a>
   [ ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-1 ]<a name="wp1036812"> </a>
<a name="wp1036813"> </a>
   [ <u class="cUnderline">NOT</u> ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-2 ]<a name="wp1036814"> </a>
<a name="wp1036815"> </a>
   [ <u class="cUnderline">END-ADD</u> ]<a name="wp1036816"> </a>
</pre></div>
<a name="wp1036817"> </a><h3 class="pHeadingRef">
Format 3
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">ADD</u> {<u class="cUnderline">CORRESPONDING</u>} group-item <u class="cUnderline">TO</u> group-item [<u class="cUnderline">ROUNDED</u>]<a name="wp1036818"> </a>
    {<u class="cUnderline">CORR</u>         }<a name="wp1036819"> </a>
<a name="wp1036820"> </a>
   [ ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-1 ]<a name="wp1036821"> </a>
<a name="wp1036822"> </a>
   [ <u class="cUnderline">NOT</u> ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-2 ]<a name="wp1036823"> </a>
<a name="wp1036824"> </a>
   [ <u class="cUnderline">END-ADD</u> ]<a name="wp1036825"> </a>
</pre></div>
<a name="wp1036826"> </a><h3 class="pHeadingRef">
Format 4
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
<u class="cUnderline">ADD</u> <u class="cUnderline">TABLE</u> src-table <u class="cUnderline">TO</u> dest-table [<u class="cUnderline">ROUNDED</u>]<a name="wp1036827"> </a>
<a name="wp1036828"> </a>
   [ <u class="cUnderline">FROM</u> INDEX src-start <u class="cUnderline">TO</u> src-end ]<a name="wp1036829"> </a>
<a name="wp1036830"> </a>
   [ <u class="cUnderline">DESTINATION</u> INDEX dest-start ]<a name="wp1036831"> </a>
<a name="wp1036832"> </a>
   [ ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-1 ]<a name="wp1036833"> </a>
<a name="wp1036834"> </a>
   [ <u class="cUnderline">NOT</u> ON <u class="cUnderline">SIZE</u> <u class="cUnderline">ERROR</u> statement-2 ]<a name="wp1036835"> </a>
<a name="wp1036836"> </a>
   [ <u class="cUnderline">END-ADD</u> ]<a name="wp1036837"> </a>
</pre></div>
<a name="wp1036838"> </a><h3 class="pHeadingRef">
Syntax Rules
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1036840"> </a><div class="pSmartList1"><li><em class="cEmphasis">Num</em> is a numeric literal or elementary numeric data item. </li></div>
<a name="wp1036841"> </a><div class="pSmartList1"><li><em class="cEmphasis">Result</em> is an elementary numeric data item or, in Format 2, an elementary numeric edited data item.</li></div>
<a name="wp1036842"> </a><div class="pSmartList1"><li><em class="cEmphasis">Group-item</em> is a group item containing one or more elementary numeric data items.  </li></div>
<a name="wp1036843"> </a><div class="pSmartList1"><li><em class="cEmphasis">Statement-1</em>, and <em class="cEmphasis">statement-2</em> are imperative statements.</li></div>
<a name="wp1036844"> </a><div class="pSmartList1"><li>CORR is an abbreviation of CORRESPONDING.</li></div>
<a name="wp1036845"> </a><div class="pSmartList1"><li><em class="cEmphasis">Src-table</em> and <em class="cEmphasis">dest-table</em> are numeric data items that are table elements.  The low-order subscript of these items must be omitted.  For example, if &quot;SRC-1&quot; was an element of a one-dimensional table, then you would just use &quot;SRC-1&quot; in the statement.  If &quot;SRC-2&quot; was an element of a two-dimensional table, and you wanted to add all the elements in row &quot;2&quot;, you would use &quot;SRC-2( 2 )&quot;.  </li></div>
<a name="wp1036846"> </a><div class="pSmartList1"><li><em class="cEmphasis">Src-start, src-end</em> and <em class="cEmphasis">dest-start</em> are numeric literals or data items.  These items may not be subscripted.  </li></div>
</ol></div>
<a name="wp1036847"> </a><h3 class="pHeadingRef">
General Rules
</h3>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1036849"> </a><div class="pSmartList1"><li>Note that pertinent additional information is located in the sections covering <a  href="gt3622.htm#wp1034781">Arithmetic Operations</a> (6.4.1), <a  href="gt3623.htm#wp1034799">Multiple Receiving Fields</a> (6.4.2), the <a  href="gt3624.htm#wp1034812">ROUNDED Option</a> (6.4.3), the <a  href="gt3625.htm#wp1034818">SIZE ERROR Option</a> (6.4.4), and the <a  href="gt3626.htm#wp1034831">CORRESPONDING Option</a> (6.4.5). </li></div>
<a name="wp1036850"> </a><div class="pSmartList1"><li>In Format 1, all <em class="cEmphasis">num</em>s are added together and their sum is then added to each <em class="cEmphasis">result</em> in turn.  </li></div>
<a name="wp1036851"> </a><div class="pSmartList1"><li>In Format 2, all <em class="cEmphasis">num</em>s are added together and their sum is moved to each <em class="cEmphasis">result</em> field.</li></div>
<a name="wp1036852"> </a><div class="pSmartList1"><li>In Format 3, each pair of corresponding elementary numeric items in the two <em class="cEmphasis">group-items</em> are added together.  The results are moved to the corresponding items in the <em class="cEmphasis">second group-item</em>.  </li></div>
<a name="wp1036853"> </a><div class="pSmartList1"><li>In Format 4, a range of <em class="cEmphasis">src-table</em> elements is added to a range of <em class="cEmphasis">dest-table</em> elements.  The results are stored in <em class="cEmphasis">dest-table</em>.  The first element of the <em class="cEmphasis">src-table</em> range is added to the first element of the <em class="cEmphasis">dest-table</em> range, the second element to the second, and so on.  </li></div>
<a name="wp1036854"> </a><div class="pSmartList1"><li><em class="cEmphasis">Src-start</em> specifies the first element of the source range.  If omitted, the value defaults to &quot;1&quot;.  <em class="cEmphasis">Src-end</em> specifies the last element of the range (inclusive).  If omitted, it is set to the current upper bound of the source table.  In a multidimensional table, the range of elements varies over the innermost OCCURS.  </li></div>
<a name="wp1036855"> </a><div class="pSmartList1"><li><em class="cEmphasis">Dest-start</em> indicates the first element of the destination range.  If omitted, it defaults to &quot;1&quot;.  Note that the last element of the destination range is <em class="cEmphasis">dest-start</em> + <em class="cEmphasis">src-end</em> <em class="cEmphasis">-1</em>. </li></div>
<a name="wp1036856"> </a><div class="pSmartList1"><li>If the SIZE ERROR phrase is used, elements for which the size error condition occurs are not updated; other elements are updated.  When an add results in a size error, <em class="cEmphasis">statement-1</em> executes, otherwise <em class="cEmphasis">statement-2</em> executes.  </li></div>
<a name="wp1036857"> </a><p class="pNoteList">
<hr />
<b>Note:  </b>A Format 4 ADD TABLE statement is usually substantially faster than an equivalent PERFORM loop.  The degree of improvement depends on the size of the range (larger ranges show better improvement).  The SIZE ERROR and ROUNDED phrases typically add significant overhead.  The runtime always performs table boundary checking in ADD TABLE, even if the program is not compiled with &quot;-Za&quot;.
<hr />
</p>
</ol></div>
<a name="wp1036858"> </a><h3 class="pHeadingRef">
Code Example
</h3>
<a name="wp1036859"> </a><h3 class="pHeadingRef">
Format 4:
</h3>
<a name="wp1036860"> </a><p class="pBody">
The following definitions will be used in the examples:
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
01  SOURCE-TABLE OCCURS 20 TIMES    PIC S9(9)V99.<a name="wp1036861"> </a>
01  DEST-TABLE OCCURS 20 TIMES      PIC S9(9)V99.<a name="wp1036862"> </a>
<a name="wp1036863"> </a>
01  ROLL-UP-TABLE.<a name="wp1036864"> </a>
    03  TOTALS OCCURS 10 TIMES.<a name="wp1036865"> </a>
        05  REPORT-SUM <a name="wp1036866"> </a>
            OCCURS 20 TIMES         PIC S9(9)V99.<a name="wp1036867"> </a>
77  CTR                             PIC 99.<a name="wp1036868"> </a>
</pre></div>
<a name="wp1036869"> </a><p class="pBody">
To add all the elements of SOURCE-TABLE to DEST-TABLE:
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
ADD TABLE SOURCE-TABLE TO DEST-TABLE<a name="wp1036870"> </a>
</pre></div>
<a name="wp1036871"> </a><p class="pBody">
To add the first five elements of SOURCE-TABLE to the last five elements of DEST-TABLE:
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
ADD TABLE SOURCE-TABLE TO DEST-TABLE<a name="wp1036872"> </a>
     FROM INDEX 1 TO 5<a name="wp1036873"> </a>
     DESTINATION INDEX 16<a name="wp1036874"> </a>
</pre></div>
<a name="wp1036875"> </a><p class="pBody">
To add all the REPORT-SUM elements in the last TOTALS row to the row &quot;above&quot; it (second to last row):
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
ADD TABLE REPORT-SUM(10) TO REPORT-SUM(9)<a name="wp1036876"> </a>
</pre></div>
<a name="wp1036877"> </a><p class="pBody">
To perform the same operation using a PERFORM loop you would have to write the following code:
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
PERFORM VARYING CTR FROM 1 BY 1 UNTIL CTR &gt; 20<a name="wp1036878"> </a>
    ADD REPORT-SUM(10, CTR) TO REPORT-SUM(9, CTR)<a name="wp1036879"> </a>
END-PERFORM<a name="wp1036880"> </a>
</pre></div>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
