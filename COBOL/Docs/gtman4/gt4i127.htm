<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 14:43:47" />
  <title>W$MOUSE Routine</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       ACUCOBOL-GT Appendices <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="gt4i.htm">Appendix I:  ACUCOBOL-GT Library Routines</a> &gt; <a href="gt4i2.htm">I.1 Library Routines</a> &gt; </p>
<a name="wp1039244"> </a><h2 class="pHeading2">
W$MOUSE Routine
</h2>
<a name="wp1039249"> </a><p class="pBody">
This routine allows you to control the behavior of the mouse.  Before using W$MOUSE to respond to mouse actions, be sure that you have unmasked the actions you want to notice (see Book 2, section 7.3).    
</p>
<a name="wp1039250"> </a><h3 class="pHeadingRef">
Usage
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
CALL &quot;W$MOUSE&quot;<a name="wp1039251"> </a>
    USING OP-CODE, parameters,<a name="wp1039252"> </a>
    GIVING MOUSE-STATUS<a name="wp1039253"> </a>
</pre></div>
<a name="wp1039254"> </a><h3 class="pHeadingRef">
Parameters
</h3>
<a name="wp1039255"> </a><p class="pBody">
<b class="cBold">OP-CODE   </b>Numeric parameter
</p>
<a name="wp1039258"> </a><p class="pBody">
This indicates the desired operation.  Level 78 symbolic names for these operations can be found in the file &quot;acugui.def&quot;.
</p>
<a name="wp1297636"> </a><p class="pBodyRelative">
</p><div>
<table border="1" cellpadding="2" cellspacing="2">
  <caption></caption>
  <tr align="left" valign="top">    <th><a name="wp1297589"> </a>
Code

</th>
    <th><a name="wp1297591"> </a>
Operation

</th>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1298174"> </a><p class="pCellBody">
0
</p>
</td>
    <td><a name="wp1298176"> </a><p class="pCellBody">
TEST-MOUSE-PRESENCE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297593"> </a><p class="pCellBody">
1
</p>
</td>
    <td><a name="wp1297595"> </a><p class="pCellBody">
GET-MOUSE-STATUS
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297597"> </a><p class="pCellBody">
2
</p>
</td>
    <td><a name="wp1297599"> </a><p class="pCellBody">
GET-MOUSE-SCREEN-STATUS
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297601"> </a><p class="pCellBody">
3
</p>
</td>
    <td><a name="wp1297603"> </a><p class="pCellBody">
SET-MOUSE-POSITION
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297605"> </a><p class="pCellBody">
4
</p>
</td>
    <td><a name="wp1297607"> </a><p class="pCellBody">
SET-MOUSE-SCREEN-POSITION
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297609"> </a><p class="pCellBody">
5
</p>
</td>
    <td><a name="wp1297611"> </a><p class="pCellBody">
SET-MOUSE-SHAPE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297613"> </a><p class="pCellBody">
6
</p>
</td>
    <td><a name="wp1297615"> </a><p class="pCellBody">
SET-DELAYED-MOUSE-SHAPE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297617"> </a><p class="pCellBody">
7
</p>
</td>
    <td><a name="wp1297619"> </a><p class="pCellBody">
GET-MOUSE-SHAPE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297621"> </a><p class="pCellBody">
8
</p>
</td>
    <td><a name="wp1297623"> </a><p class="pCellBody">
CAPTURE-MOUSE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297625"> </a><p class="pCellBody">
9
</p>
</td>
    <td><a name="wp1297627"> </a><p class="pCellBody">
RELEASE-MOUSE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297629"> </a><p class="pCellBody">
10
</p>
</td>
    <td><a name="wp1297631"> </a><p class="pCellBody">
ENABLE-MOUSE
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297633"> </a><p class="pCellBody">
19
</p>
</td>
    <td><a name="wp1297635"> </a><p class="pCellBody">
SET-MOUSE-HELP
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297779"> </a><p class="pCellBody">
23
</p>
</td>
    <td><a name="wp1297781"> </a><p class="pCellBody">
SET-MOUSE-POSITION-EX
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297775"> </a><p class="pCellBody">
24
</p>
</td>
    <td><a name="wp1297777"> </a><p class="pCellBody">
SET-MOUSE-SCREEN-POSITION-EX
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1297771"> </a><p class="pCellBody">
25
</p>
</td>
    <td><a name="wp1297773"> </a><p class="pCellBody">
SET-MOUSE-POSITION-PIXEL
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1298148"> </a><p class="pCellBody">
26
</p>
</td>
    <td><a name="wp1298150"> </a><p class="pCellBody">
SET-MOUSE-SCREEN-POSITION-PIXEL
</p>
</td>
</tr>
</table>
</div>
<p class="pBodyRelative">
</p>
<a name="wp1270422"> </a><p class="pBody">
<b class="cBold">parameters</b>  Vary depending on the op-code chosen.
</p>
<a name="wp1039259"> </a><p class="pBody">
<b class="cBold">MOUSE-STATUS   </b>A numeric data item
</p>
<a name="wp1270428"> </a><p class="pBody">
Holds the return value from W$MOUSE.  This is used only with the ENABLE-MOUSE, TEST-MOUSE-PRESENCE, and GET-MOUSE-SHAPE operations.
</p>
<a name="wp1270429"> </a><h3 class="pHeadingRef">
Description
</h3>
<a name="wp1270431"> </a><p class="pBody">
The first parameter you pass to W$MOUSE is an operation code.  This code tells W$MOUSE what to do.  The number and type of the remaining parameters depend on the operation selected.  All parameters are passed BY REFERENCE (the default in COBOL).  The operation code can be one of the following:    
</p>
<a name="wp1039266"> </a><h3 class="pHeadingRef">
ENABLE-MOUSE (op-code 10) 
</h3>
<a name="wp1329870"> </a><p class="pBody">
Turns on the mouse on character-based systems.  (By default the mouse is invisible.)  The value of RETURN-CODE is set to &quot;1&quot; if a mouse is present, &quot;0&quot; if no mouse is found.  (Takes no additional parameters.) 
</p>
<a name="wp1039270"> </a><p class="pBody">
On some machines there is an appreciable delay when the mouse is enabled.
</p>
<a name="wp1039271"> </a><p class="pBody">
Under graphical environments such as Windows, ENABLE-MOUSE is not necessary.  It sets the value of RETURN-CODE properly, but no other action occurs, because the mouse is <em class="cEmphasis">always </em>enabled in these environments.
</p>
<a name="wp1039273"> </a><h3 class="pHeadingRef">
TEST-MOUSE-PRESENCE (op-code 0) 
</h3>
<a name="wp1329896"> </a><p class="pBody">
Used to detect the presence of a mouse.  The value of RETURN-CODE is set to &quot;1&quot; if a mouse is available on the system.  It is set to &quot;0&quot; if no mouse is present.  (Takes no additional parameters.)  Note that on character-based systems, the mouse must be enabled before its presence can be detected.  So if you haven't enabled the mouse (see ENABLE-MOUSE above), RETURN-CODE will have a value of &quot;0&quot;.
</p>
<a name="wp1270521"> </a><h3 class="pHeadingRef">
GET-MOUSE-STATUS (op-code 1)  
</h3>
<a name="wp1329904"> </a><p class="pBody">
Returns information about the mouse's location and the state of each of its buttons.  You must pass a group item with the following structure (defined in &quot;acugui.def&quot;):
</p>
<div class="pPreformatted"><pre class="pPreformatted">
01  MOUSE-INFO.<a name="wp1270638"> </a>
   03  MOUSE-ROW               PIC 9(4) COMP-1.<a name="wp1270639"> </a>
       88  MOUSE-OFF-SCREEN    VALUE ZERO.<a name="wp1270640"> </a>
   03  MOUSE-COL               PIC 9(4) COMP-1.<a name="wp1270641"> </a>
   03  LBUTTON-STATUS          PIC 9.<a name="wp1270642"> </a>
       88  LBUTTON-DOWN        VALUE 1.<a name="wp1270643"> </a>
   03  MBUTTON-STATUS          PIC 9.<a name="wp1270644"> </a>
       88  MBUTTON-DOWN        VALUE 1.<a name="wp1270645"> </a>
   03  RBUTTON-STATUS          PIC 9.<a name="wp1270646"> </a>
       88  RBUTTON-DOWN        VALUE 1.<a name="wp1270647"> </a>
   03  MOUSE-ROW-EX            PIC 9(6)V99 COMP-4, SYNC.<a name="wp1270648"> </a>
   03  MOUSE-COL-EX            PIC 9(6)V99 COMP-4.<a name="wp1270649"> </a>
   03  MOUSE-ROW-PIXEL         PIC 9(8) COMP-4.<a name="wp1270650"> </a>
   03  MOUSE-COL-PIXEL         PIC 9(8) COMP-4.<a name="wp1270527"> </a>
</pre></div>
<a name="wp1270529"> </a><p class="pBody">
The routine fills in this structure with data about the mouse.  Each of the three &quot;status&quot; fields is set to &quot;1&quot; if the corresponding button is depressed.  Otherwise, they are set to zero.  The various row and column fields are set to the location of the mouse within the current ACUCOBOL-GT window.  If the mouse is outside of the current window, then these values are set to zero.    
</p>
<a name="wp1039289"> </a><p class="pBody">
Here's an example of a call to W$MOUSE that returns the menu item the mouse is pointing to:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
* find-mouse-menu-row - returns (in mouse-row) <a name="wp1039290"> </a>
* the menu item that the mouse pointer is <a name="wp1039291"> </a>
* currently on. If the mouse is not on a menu <a name="wp1039292"> </a>
* item, it returns zero.<a name="wp1039293"> </a>
<a name="wp1039294"> </a>
find-mouse-menu-row. <a name="wp1039295"> </a>
   call &quot;w$mouse&quot; using get-mouse-status, mouse-info <a name="wp1039296"> </a>
   if mouse-row &gt;= menu-row and <a name="wp1039297"> </a>
         mouse-row &lt; menu-row + num-menu-items * 2 <a name="wp1039299"> </a>
      compute mouse-row = mouse-row - menu-row + 1 <a name="wp1039300"> </a>
   else <a name="wp1039301"> </a>
      move zero to mouse-row.<a name="wp1039302"> </a>
</pre></div>
<a name="wp1039303"> </a><p class="pBody">
After an ACCEPT statement is executed, all CALLs to W$MOUSE pertain to that ACCEPT statement, until another ACCEPT is executed.  So, you always get the right mouse status.  By synchronizing the mouse actions with the appropriate exception values, the runtime ensures that you process the mouse correctly.  
</p>
<a name="wp1039305"> </a><h3 class="pHeadingRef">
GET-MOUSE-SCREEN-STATUS (op-code 2) 
</h3>
<a name="wp1329917"> </a><p class="pBody">
This function is the same as the GET-MOUSE-STATUS function, except that the row and column coordinates are relative to the application's virtual screen instead of the current window.  If the mouse is not located anywhere in the application's window, then the coordinates are set to zero.
</p>
<a name="wp1039310"> </a><h3 class="pHeadingRef">
SET-MOUSE-POSITION (op-code 3) 
</h3>
<a name="wp1329924"> </a><p class="pBody">
You must pass a group item with the same structure as described under GET-MOUSE-STATUS.  The mouse is placed at the coordinates named by MOUSE-ROW and MOUSE-COL, relative to the current ACUCOBOL-GT window.  The button-status fields are not used.
</p>
<a name="wp1270708"> </a><h3 class="pHeadingRef">
SET-MOUSE-POSITION-EX (op-code 23) 
</h3>
<a name="wp1329925"> </a><p class="pBody">
You must pass a group item with the same structure as described under GET-MOUSE-STATUS.  The mouse is placed at the coordinates named by MOUSE-ROW-EX and MOUSE-COL-EX, relative to the current ACUCOBOL-GT window.  These coordinates are similar to MOUSE-ROW and MOUSE-COL, except that the positioning of the mouse is performed using a precision of hundredths of cells.  The button-status fields are not used.
</p>
<a name="wp1270705"> </a><h3 class="pHeadingRef">
SET-MOUSE-POSITION-PIXEL (op-code 25) 
</h3>
<a name="wp1329942"> </a><p class="pBody">
You must pass a group item with the same structure as described under GET-MOUSE-STATUS.  The mouse is placed at the coordinates named by MOUSE-ROW-PIXEL and MOUSE-COL-PIXEL, relative to the current ACUCOBOL-GT window.  These coordinates describe the mouse position in terms of the display's base units (which are pixels for graphical systems).  Unlike MOUSE-ROW and MOUSE-COL, or MOUSE-ROW-EX and MOUSE-COL-EX, the uppermost pixel is row &quot;0&quot;/column &quot;0&quot; instead of row &quot;1&quot;/column &quot;1&quot;.  The button-status fields are not used.
</p>
<a name="wp1039315"> </a><h3 class="pHeadingRef">
SET-MOUSE-SCREEN-POSITION (op-code 4) 
</h3>
<a name="wp1329994"> </a><p class="pBody">
This is the same as SET-MOUSE-POSITION, except that the position is relative to the application's virtual screen.  
</p>
<a name="wp1270963"> </a><h3 class="pHeadingRef">
SET-MOUSE-SCREEN-POSITION-EX (op-code 24) 
</h3>
<a name="wp1329995"> </a><p class="pBody">
The same as SET-MOUSE-POSITION-EX, except that the position is relative to the application's virtual screen.  
</p>
<a name="wp1270956"> </a><h3 class="pHeadingRef">
SET-MOUSE-SCREEN-POSITION-PIXEL (op-code 26) 
</h3>
<a name="wp1330061"> </a><p class="pBody">
The same as SET-MOUSE-POSITION-PIXEL, except that the position is relative to the application's virtual screen.  
</p>
<a name="wp1039320"> </a><h3 class="pHeadingRef">
SET-MOUSE-SHAPE (op-code 5)  
</h3>
<a name="wp1330062"> </a><p class="pBody">
The second parameter defines the desired shape of the mouse pointer.  The shape is changed immediately, even if the mouse has not been moved.  The possible values are: 
</p>
<a name="wp1039346"> </a><p class="pBodyRelative">
</p><div>
<table border="0" cellpadding="6" cellspacing="1">
  <caption></caption>
  <tr align="left" valign="top">    <td><a name="wp1039327"> </a><p class="pCellBody">
ARROW-POINTER
</p>
</td>
    <td><a name="wp1039329"> </a><p class="pCellBody">
The default arrow shape
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1039331"> </a><p class="pCellBody">
BAR-POINTER
</p>
</td>
    <td><a name="wp1039333"> </a><p class="pCellBody">
A vertical bar
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1039335"> </a><p class="pCellBody">
CROSS-POINTER
</p>
</td>
    <td><a name="wp1039337"> </a><p class="pCellBody">
Cross hairs
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1039339"> </a><p class="pCellBody">
HELP-POINTER
</p>
</td>
    <td><a name="wp1039341"> </a><p class="pCellBody">
A question mark
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1039343"> </a><p class="pCellBody">
WAIT-POINTER
</p>
</td>
    <td><a name="wp1039345"> </a><p class="pCellBody">
An hourglass
</p>
</td>
</tr>
</table>
</div>
<p class="pBodyRelative">
</p>
<a name="wp1039347"> </a><p class="pBody">
These are defined in &quot;acugui.def&quot;.  Note that the runtime system changes the shape of the mouse when you are using automatic mouse handling.  When an ACCEPT statement finishes execution, the last shape defined by SET-MOUSE-SHAPE is restored.    
</p>
<a name="wp1039349"> </a><h3 class="pHeadingRef">
SET-DELAYED-MOUSE-SHAPE (op-code 6) 
</h3>
<a name="wp1330076"> </a><p class="pBody">
This is identical to SET-MOUSE-SHAPE, except that the mouse pointer is not changed immediately.  Instead, it is changed as soon as the user moves it.  The automatic mouse handler uses this function to provide a smoother mouse appearance.
</p>
<a name="wp1039354"> </a><h3 class="pHeadingRef">
GET-MOUSE-SHAPE (op-code 7) 
</h3>
<a name="wp1330077"> </a><p class="pBody">
The value of RETURN-CODE is set to the current mouse shape.  If SET-DELAYED-MOUSE-SHAPE is in effect, waiting for the mouse to move, then the delayed shape is returned.  (Takes no additional parameters.)
</p>
<a name="wp1039359"> </a><h3 class="pHeadingRef">
CAPTURE-MOUSE (op-code 8) 
</h3>
<a name="wp1330078"> </a><p class="pBody">
Normally, only mouse actions that occur within the application's <em class="cEmphasis">virtual screen</em> are processed by the runtime system.  (The virtual screen is the drawing space allocated to the application.)  Actions that occur outside of this space are handled by other applications or by the environment.  The CAPTURE-MOUSE function causes the runtime to process all mouse messages, regardless of where they occur.  This should be done only in special cases, because it prevents the user from using the mouse in any other application.  Normally, you capture the mouse only when the user is marking or dragging some object on the screen.  By capturing the mouse, you can control the action even if the user accidentally moves the mouse outside of the application.  (Takes no additional parameters.)
</p>
<a name="wp1039363"> </a><p class="pBody">
When the mouse is captured, if the mouse is outside of the legal boundaries, the GET-MOUSE-STATUS and GET-MOUSE-SCREEN-STATUS functions no longer return zero in the row and column fields.  Instead, the row and column fields contain the nearest legal coordinate to the mouse's actual position.  
</p>
<a name="wp1039365"> </a><h3 class="pHeadingRef">
RELEASE-MOUSE (op-code 9) 
</h3>
<a name="wp1330110"> </a><p class="pBody">
This reverses the effects of the CAPTURE-MOUSE function.  You must call this sometime after calling CAPTURE-MOUSE, or the environment will not be able to use the mouse again.  (Takes no additional parameters.)
</p>
<a name="wp1039370"> </a><h3 class="pHeadingRef">
SET-MOUSE-HELP (op-code 19) 
</h3>
<a name="wp1330111"> </a><p class="pBody">
When the second parameter is &quot;1&quot;, this op-code turns the mouse pointer into a <em class="cEmphasis">help-mode</em> pointer--the mouse is captured and the pointer takes the shape of a question mark.  When the second parameter is &quot;0&quot;, the help-mode state is turned off--the mouse is released and the pointer returns to its default shape.  This option is only supported under Microsoft Windows.
</p>
<a name="wp1039374"> </a><p class="pNote">
<hr />
<b>Note:  </b>If you use <em class="cEmphasis">help automation </em>(see Chapter 10 in Book 2, <em class="cEmphasis">User Interface Programming</em>), you don't need to use this option.  Help automation automatically manages the help-mode mouse states for you. 
<hr />
</p>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com subject=E-01-DS-060621-ACUCOBOL-GT-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
