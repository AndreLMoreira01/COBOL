<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 14:43:47" />
  <title>REG_SET_VALUE_EX, DISPLAY_REG_SET_VALUE_EX Routine</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       ACUCOBOL-GT Appendices <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="gt4i.htm">Appendix I:  ACUCOBOL-GT Library Routines</a> &gt; <a href="gt4i2.htm">I.1 Library Routines</a> &gt; </p>
<a name="wp1038102"> </a><h2 class="pHeading2">
REG_SET_VALUE_EX, DISPLAY_REG_SET_VALUE_EX Routine
</h2>
<a name="wp1038110"> </a><p class="pBody">
Sets value and type information for a specified open registry key.  
</p>
<a name="wp1207386"> </a><p class="pBody">
Use DISPLAY_REG_SET_VALUE_EX to perform the action on the display host's registry (the local host when the application is run with a standard runtime; the <em class="cEmphasis">thin client</em> when the application is run with the thin client).  Use REG_SET_VALUE_EX to perform the action on the server host's registry (the local host when the application is run with a standard runtime, and the application host when the application is run with the thin client).
</p>
<a name="wp1080512"> </a><h3 class="pHeadingRef">
Usage
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
CALL &quot;REG_SET_VALUE_EX&quot;<a name="wp1038111"> </a>
    USING OPEN-KEY-HANDLE, DATA-TYPE, VALUE-DATA, DATA-SIZE,<a name="wp1038112"> </a>
    GIVING STATUS-CODE<a name="wp1038116"> </a>
</pre></div>
<a name="wp1038117"> </a><p class="pBody">
or:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
CALL &quot;REG_SET_VALUE_EX&quot;<a name="wp1038118"> </a>
    USING OPEN-KEY-HANDLE, DATA-TYPE, VALUE-DATA, DATA-SIZE,<a name="wp1038119"> </a>
        VALUE-NAME,<a name="wp1038123"> </a>
    GIVING STATUS-CODE<a name="wp1038124"> </a>
</pre></div>
<a name="wp1038125"> </a><h3 class="pHeadingRef">
Parameters
</h3>
<a name="wp1038126"> </a><p class="pBody">
<b class="cBold">OPEN-KEY-HANDLE</b>  Usage unsigned-long
</p>
<a name="wp1038127"> </a><p class="pBody">
Handle of a currently open key or one of the following predefined handles of keys that are always open (defined in &quot;acugui.def&quot;):
</p>
<a name="wp1038128"> </a><p class="pBody">
HKEY_CLASSES_ROOT
</p>
<a name="wp1038129"> </a><p class="pBody">
HKEY_CURRENT_USER
</p>
<a name="wp1038130"> </a><p class="pBody">
HKEY_LOCAL_MACHINE
</p>
<a name="wp1038131"> </a><p class="pBody">
HKEY_USERS
</p>
<a name="wp1038132"> </a><p class="pBody">
<b class="cBold">DATA-TYPE</b>  Usage unsigned-long
</p>
<a name="wp1038133"> </a><p class="pBody">
Specifies the type code for the value entry.  The type code can be one of the following values (defined in &quot;acugui.def&quot;):
</p>
<a name="wp1059225"> </a><p class="pBody">
 </p><div>
<table border="1" cellpadding="2" cellspacing="2">
  <caption></caption>
  <tr align="left" valign="top">    <th><a name="wp1058740"> </a>
Value

</th>
    <th><a name="wp1058742"> </a>
Meaning

</th>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058744"> </a><p class="pCellBody">
REG_BINARY
</p>
</td>
    <td><a name="wp1058746"> </a><p class="pCellBody">
Binary data in any form.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058748"> </a><p class="pCellBody">
REG_DWORD
</p>
</td>
    <td><a name="wp1058750"> </a><p class="pCellBody">
A 32-bit number.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058752"> </a><p class="pCellBody">
REG_DWORD_LITTLE_ENDIAN
</p>
</td>
    <td><a name="wp1058754"> </a><p class="pCellBody">
A 32-bit number in little-endian format (same as REG_DWORD).  In little-endian format, the most significant byte of a word is the high-order word.  This is the most common format for computers running Windows and Windows NT.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058756"> </a><p class="pCellBody">
REG_DWORD_BIG_ENDIAN
</p>
</td>
    <td><a name="wp1058758"> </a><p class="pCellBody">
A 32-bit number in big-endian format.  In big-endian format, the most significant byte of a word is the low-order word.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058760"> </a><p class="pCellBody">
REG_EXPAND_SZ
</p>
</td>
    <td><a name="wp1058762"> </a><p class="pCellBody">
A null-terminated string that contains unexpanded references to environment variables (for example, &quot;%PATH%&quot;).  It will be a Unicode or ANSI string depending on whether you use the Unicode or ANSI functions.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058764"> </a><p class="pCellBody">
REG_LINK
</p>
</td>
    <td><a name="wp1058766"> </a><p class="pCellBody">
A Unicode symbolic link.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058768"> </a><p class="pCellBody">
REG_MULTI_SZ
</p>
</td>
    <td><a name="wp1058770"> </a><p class="pCellBody">
An array of null-terminated strings, terminated by two null characters.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058772"> </a><p class="pCellBody">
REG_NONE
</p>
</td>
    <td><a name="wp1058774"> </a><p class="pCellBody">
No defined value type.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058776"> </a><p class="pCellBody">
REG_RESOURCE_LIST
</p>
</td>
    <td><a name="wp1058778"> </a><p class="pCellBody">
A device-driver resource list.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1058780"> </a><p class="pCellBody">
REG_SZ 
</p>
</td>
    <td><a name="wp1058782"> </a><p class="pCellBody">
A null-terminated string.  It will be a Unicode or ANSI string, depending on whether you use the Unicode or ANSI functions.
</p>
</td>
</tr>
</table>
</div>
<p class="pBody">
</p>
<a name="wp1038180"> </a><p class="pBody">
<b class="cBold">VALUE-DATA</b>   Variable parameter
</p>
<a name="wp1038181"> </a><p class="pBody">
Buffer to set the data for the value entry. If you know what type of data is being returned, you may specify this parameter accordingly.  If the type of data returned is unknown, you may specify a group item structured as follows:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
01 VALUE-DATA<a name="wp1164967"> </a>
   02 VALUE-DATA-ORIG                                PIC X (n).<a name="wp1164968"> </a>
   02 VALUE-BINARY redefines VALUE-DATA-ORIG         PIC X (n).<a name="wp1164969"> </a>
   02 VALUE-DWORD redefines VALUE-DATA-ORIG          Usage signed-long.<a name="wp1164970"> </a>
   02 VALUE-LIT-ENDIAN redefines VALUE-DATA-ORIG     Usage signed-long.<a name="wp1164971"> </a>
   02 VALUE-BIG-ENDIAN redefines VALUE-DATA-ORIG     S9 (9) COMP-4.<a name="wp1164972"> </a>
   02 VALUE-EXPAND-SZ redefines VALUE-DATA-ORIG      PIC X (n).<a name="wp1164973"> </a>
   02 VALUE-LINK redefines VALUE-DATA-ORIG           PIC X (n).<a name="wp1164974"> </a>
   02 VALUE-MULTI-SZ redefines VALUE-DATA-ORIG       PIC X (n).<a name="wp1164975"> </a>
   02 VALUE-NONE redefines VALUE-DATA-ORIG           PIC X (n).<a name="wp1164976"> </a>
   02 VALUE-RESOURCE-LIST redefines VALUE-DATA-ORIG  PIC X (n).<a name="wp1164977"> </a>
   02 VALUE-SZ redefines VALUE-DATA-ORIG             PIC X (n).<a name="wp1164978"> </a>
</pre></div>
<a name="wp1038194"> </a><p class="pBody">
<b class="cBold">DATA-SIZE</b>   Usage unsigned-long
</p>
<a name="wp1038195"> </a><p class="pBody">
Specifies the size, in bytes, of the information in the VALUE-DATA buffer.  If the data is of type REG_SZ, REG_EXPAND_SZ, or REG_MULTI_SZ, DATA-SIZE must include the size of the terminating null character. 
</p>
<a name="wp1038196"> </a><p class="pBody">
<b class="cBold">VALUE-NAME</b>  PIC  X(n)
</p>
<a name="wp1038197"> </a><p class="pBody">
Name of the value to set.  If a value with this name is not already present in the key, the function adds it to the key.
</p>
<a name="wp1038198"> </a><p class="pBody">
<b class="cBold">STATUS-CODE</b>    Numeric data item.
</p>
<a name="wp1038199"> </a><p class="pBody">
Receives the return status of call to Microsoft's &quot;RegSetValueEx&quot; function.  A return status of zero indicates success; non-zero indicates that an error occurred.
</p>
<a name="wp1038200"> </a><h3 class="pHeadingRef">
Comments
</h3>
<a name="wp1038201"> </a><p class="pBody">
Value lengths are limited by available memory.  Long values (more than 2048 bytes) should be stored as files with the filenames stored in the registry.  This helps the registry perform efficiently.  Application elements such as icons, bitmaps, and executable files should be stored as files and not be placed in the registry. 
</p>
<a name="wp1038202"> </a><p class="pBody">
The key identified by the OPEN-KEY-HANDLE parameter must have been opened with KEY_SET_VALUE access.  
</p>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com subject=E-01-DS-060621-ACUCOBOL-GT-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
