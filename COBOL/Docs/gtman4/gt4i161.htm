<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 14:43:47" />
  <title>WINPRINT-GET-CURRENT-INFO-EX</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       ACUCOBOL-GT Appendices <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="gt4i.htm">Appendix I:  ACUCOBOL-GT Library Routines</a> &gt; <a href="gt4i2.htm">I.1 Library Routines</a> &gt; <a href="gt4i137.htm">WIN$PRINTER Routine</a> &gt; </p>
<a name="wp1040551"> </a><h2 class="pHeading3">
WINPRINT-GET-CURRENT-INFO-EX
</h2>
<a name="wp1204725"> </a><p class="pBody">
This operation code returns additional information about the currently selected printer, extending the functionality of  WINPRINT-GET-CURRENT-INFO. 
</p>
<a name="wp1204726"> </a><h3 class="pHeadingRef">
Usage
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
CALL &quot;WIN$PRINTER&quot;<a name="wp1040558"> </a>
    USING WINPRINT-GET-CURRENT-INFO-EX, WINPRINT-SELECTION<a name="wp1040559"> </a>
    GIVING RESULT<a name="wp1040560"> </a>
</pre></div>
<a name="wp1040561"> </a><h3 class="pHeadingRef">
Parameters
</h3>
<a name="wp1040562"> </a><p class="pBody">
<b class="cBold">WINPRINT-SELECTION</b>   Group item defined in &quot;winprint.def&quot; as follows:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
01  WINPRINT-SELECTION.<a name="wp1040563"> </a>
   03 WINPRINT-NAME                    PIC X(80).<a name="wp1040564"> </a>
   03 WINPRINT-PORT                    PIC X(80).<a name="wp1040565"> </a>
   03 WINPRINT-DRIVER                  PIC X(80).<a name="wp1040566"> </a>
   03 WINPRINT-DRV-VERSION             SIGNED-INT.<a name="wp1040567"> </a>
   03 WINPRINT-NO-OF-PRINTERS          SIGNED-SHORT.<a name="wp1040568"> </a>
   03 WINPRINT-IS-DEFAULT              SIGNED-SHORT.<a name="wp1040569"> </a>
   03 WINPRINT-COPIES                  SIGNED-SHORT.<a name="wp1040570"> </a>
   03 WINPRINT-ORIENTATION             SIGNED-SHORT.<a name="wp1040571"> </a>
   03 WINPRINT-QUALITY                 SIGNED-SHORT.<a name="wp1040572"> </a>
   03 WINPRINT-CURR-ORIENTATION        SIGNED-SHORT.<a name="wp1040573"> </a>
   03 WINPRINT-CURR-COPIES             SIGNED-SHORT.<a name="wp1040574"> </a>
   03 WINPRINT-DUPLEX                  SIGNED-SHORT.<a name="wp1040575"> </a>
   03 WINPRINT-COLLATE                 SIGNED-SHORT.<a name="wp1040576"> </a>
   03 WINPRINT-COLOR                   SIGNED-SHORT.<a name="wp1040577"> </a>
   03 WINPRINT-CURR-DUPLEX             SIGNED-SHORT.<a name="wp1040578"> </a>
   03 WINPRINT-CURR-COLLATE            SIGNED-SHORT.<a name="wp1040579"> </a>
   03 WINPRINT-CURR-PAPERSIZE          SIGNED-SHORT.<a name="wp1040580"> </a>
   03 WINPRINT-CURR-TRAY               SIGNED-SHORT.<a name="wp1040581"> </a>
   03 WINPRINT-CURR-COLOR              SIGNED-SHORT.<a name="wp1040582"> </a>
   03 WINPRINT-JOB-TITLE               PIC X(80).<a name="wp1040583"> </a>
</pre></div>
<a name="wp1040584"> </a><p class="pBody">
This group item has numerous conditional variables.  See &quot;winprint.def&quot; for the complete list.
</p>
<a name="wp1040585"> </a><h3 class="pHeadingRef">
Return Values
</h3>
<a name="wp1040586"> </a><p class="pBody">
A printer is considered selected if it has performed a print using &quot;-Q &lt;<em class="cEmphasis">printername</em>&gt;&quot; or &quot;-P SPOOLER&quot;, or if WIN$PRINTER has executed using any of the WINPRINT-DATA op-codes.  If no printer is selected, this operation will return information about the Windows default printer.  
</p>
<a name="wp1040587"> </a><h3 class="pHeadingRef">
Description
</h3>
<a name="wp1040588"> </a><p class="pBody">
The printer may be open or closed to perform these functions.  There is no need to reset any of these functions.  WINPRINT-SELECTION should be initialized prior to use.  WINPRINT-GET-CURRENT-INFO-EX has all the same values as WINPRINT-GET-CURRENT-INFO plus the following additional values:
</p>
<a name="wp1040589"> </a><p class="pBody">
<b class="cBold">WINPRINT-DUPLEX</b> -- Determines if the currently selected printer supports duplex printing. If yes, the returned value is WPRT-HAS-DUPLEX.
</p>
<a name="wp1040590"> </a><p class="pBody">
<b class="cBold">WINPRINT-COLLATE</b> -- Determines if the currently selected printer supports collating. If yes, the returned value is WPRT-HAS-COLLATE.
</p>
<a name="wp1040591"> </a><p class="pBody">
<b class="cBold">WINPRINT-COLOR</b> -- Determines if the currently selected printer can print in color.  If color printing is supported, the returned value is WPRT-HAS-COLOR.
</p>
<a name="wp1040592"> </a><p class="pBody">
<b class="cBold">WINPRINT-CURR-DUPLEX</b> -- Returns the current duplex setting of the printer. Possible values are: WPRT-SIMPLEX, WPRT-DUPLEX-VERTICAL, and WPRT-DUPLEX-HORIZONTAL.
</p>
<a name="wp1040593"> </a><p class="pBody">
<b class="cBold">WINPRINT-CURR-COLLATE</b> -- Determines if the collating feature of the currently selected printer is turned on or off.
</p>
<a name="wp1040594"> </a><p class="pBody">
<b class="cBold">WINPRINT-CURR-PAPERSIZE</b> -- Returns the current paper size selected in the printer driver.  Values less than 42 should correspond to the PAPER-SIZES table in &quot;winprint.def&quot;.  Values greater than 41 and less than 69 are defined by version 4.x of Windows NT.  Values greater than 68 and less than 119 are defined in Windows 2000.  Values greater than 118 and less than 256 are considered undefined.  Values greater than 255 are considered user defined.
</p>
<a name="wp1040595"> </a><p class="pBody">
<b class="cBold">WINPRINT-CURR-TRAY</b> -- Returns the currently selected paper tray as defined in the printer driver. Values less than 16 should correspond to the PAPER-TRAYS table in &quot;winprint.def&quot;.  Values greater than 15 and less than 256 are considered undefined.  Values greater than 255 are considered device specific.
</p>
<a name="wp1040596"> </a><p class="pBody">
Values 12 and 13 are not defined in the PAPER-SIZES table in &quot;winprint.def&quot;.  This matches a similar gap in the Windows API.  Refer to &quot;prndemox.cbl&quot; for an example of how to compensate for these undefined values.   
</p>
<a name="wp1040597"> </a><p class="pBody">
<b class="cBold">WINPRINT-CURR-COLOR</b> - Determines if the printer is in the proper mode to print in color.  If yes, WPRT-COLOR is returned.  Monochromatic printers or color printers with color support disabled return WPRT-MONOCHROME.
</p>
<a name="wp1204787"> </a><p class="pNote">
<hr />
<b>Note:  </b>When using one of these extended operations, it is best to pair it with a corresponding extended operation. For example, use <span style="font-family: Arial, Verdana, Helvetica, sans-serif">WINPRINT-GET-CURRENT-INFO-EX </span>with <span style="font-family: Arial, Verdana, Helvetica, sans-serif">WINPRINT-SET-PRINTER-EX</span>, instead of with <span style="font-family: Arial, Verdana, Helvetica, sans-serif">WINPRINT-SET-PRINTER</span>.
<hr />
</p>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com subject=E-01-DS-060621-ACUCOBOL-GT-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
