<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 14:43:47" />
  <title>REG_ENUM_VALUE, DISPLAY_REG_ENUM_VALUE Routine</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       ACUCOBOL-GT Appendices <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="gt4i.htm">Appendix I:  ACUCOBOL-GT Library Routines</a> &gt; <a href="gt4i2.htm">I.1 Library Routines</a> &gt; </p>
<a name="wp1037725"> </a><h2 class="pHeading2">
REG_ENUM_VALUE, DISPLAY_REG_ENUM_VALUE Routine
</h2>
<a name="wp1037731"> </a><p class="pBody">
Enumerates the values of a specified registry key.  REG_ENUM_VALUE retrieves the name of one value each time it is called.  
</p>
<a name="wp1207106"> </a><p class="pBody">
Use DISPLAY_REG_ENUM_VALUE to perform the action on the display host's registry (the local host when the application is run with a standard runtime; the <em class="cEmphasis">thin client</em> when the application is run with the thin client).  Use REG_ENUM_VALUE to perform the action on the server host's registry (the local host when the application is run with a standard runtime, and the application host when the application is run with the thin client).
</p>
<a name="wp1037732"> </a><h3 class="pHeadingRef">
Usage
</h3>
<div class="pPreformatted"><pre class="pPreformatted">
CALL &quot;REG_ENUM_VALUE&quot;<a name="wp1037733"> </a>
    USING OPEN-KEY-HANDLE, NDX, VALUE-NAME, NAME-SIZE,<a name="wp1037734"> </a>
        DATA-TYPE, VALUE-DATA, DATA-SIZE,<a name="wp1037738"> </a>
    GIVING STATUS-CODE<a name="wp1037741"> </a>
</pre></div>
<a name="wp1037742"> </a><h3 class="pHeadingRef">
Parameters
</h3>
<a name="wp1037743"> </a><p class="pBody">
<b class="cBold">OPEN-KEY-HANDLE</b>  Usage unsigned-long
</p>
<a name="wp1037744"> </a><p class="pBody">
Handle of a currently open key or one of the following predefined handles of keys that are always open (defined in &quot;acugui.def&quot;):
</p>
<a name="wp1037745"> </a><p class="pBody">
HKEY_CLASSES_ROOT
</p>
<a name="wp1037746"> </a><p class="pBody">
HKEY_CURRENT_USER
</p>
<a name="wp1037747"> </a><p class="pBody">
HKEY_LOCAL_MACHINE
</p>
<a name="wp1037748"> </a><p class="pBody">
HKEY_USERS
</p>
<a name="wp1037749"> </a><p class="pBody">
<b class="cBold">NDX</b>   Numeric data item
</p>
<a name="wp1037750"> </a><p class="pBody">
Specifies the index of the value to retrieve.  NDX should be set to `1' for the first call to REG_ENUM_VALUE and then incremented for subsequent calls.  The values are not returned in any particular order.
</p>
<a name="wp1037751"> </a><p class="pBody">
<b class="cBold">VALUE-NAME</b>  PIC  X(n)
</p>
<a name="wp1037752"> </a><p class="pBody">
Receives the name of the value.
</p>
<a name="wp1037753"> </a><p class="pBody">
<b class="cBold">NAME-SIZE</b>    Usage unsigned-long
</p>
<a name="wp1037754"> </a><p class="pBody">
Specifies the size, in characters, of the VALUE-NAME buffer.  When the function returns, NAME-SIZE contains the size of the string copied to VALUE-NAME.
</p>
<a name="wp1037755"> </a><p class="pBody">
<b class="cBold">DATA-TYPE</b>  Usage unsigned-long
</p>
<a name="wp1037756"> </a><p class="pBody">
Points to a variable that receives the type code for the value entry.  The type code can be one of the following values (defined in &quot;acugui.def&quot;):
</p>
<a name="wp1057227"> </a><p class="pBody">
 </p><div>
<table border="1" cellpadding="2" cellspacing="2">
  <caption></caption>
  <tr align="left" valign="top">    <th><a name="wp1056891"> </a>
Value

</th>
    <th><a name="wp1056893"> </a>
Meaning

</th>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056895"> </a><p class="pCellBody">
REG_BINARY
</p>
</td>
    <td><a name="wp1056897"> </a><p class="pCellBody">
Binary data in any form.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056899"> </a><p class="pCellBody">
REG_DWORD
</p>
</td>
    <td><a name="wp1056901"> </a><p class="pCellBody">
A 32-bit number.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056903"> </a><p class="pCellBody">
REG_DWORD_LITTLE_ENDIAN
</p>
</td>
    <td><a name="wp1056905"> </a><p class="pCellBody">
A 32-bit number in little-endian format (same as REG_DWORD).  In little-endian format, the most significant byte of a word is the high-order word.  This is the most common format for computers running Windows and Windows NT.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056907"> </a><p class="pCellBody">
REG_DWORD_BIG_ENDIAN
</p>
</td>
    <td><a name="wp1056909"> </a><p class="pCellBody">
A 32-bit number in big-endian format.  In big-endian format, the most significant byte of a word is the low-order word.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056911"> </a><p class="pCellBody">
REG_EXPAND_SZ
</p>
</td>
    <td><a name="wp1056913"> </a><p class="pCellBody">
A null-terminated string that contains unexpanded references to environment variables (for example, &quot;%PATH%&quot;).   It will be a Unicode or ANSI string depending on whether you use the Unicode or ANSI functions.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056915"> </a><p class="pCellBody">
REG_LINK
</p>
</td>
    <td><a name="wp1056917"> </a><p class="pCellBody">
A Unicode symbolic link.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056919"> </a><p class="pCellBody">
REG_MULTI_SZ
</p>
</td>
    <td><a name="wp1056921"> </a><p class="pCellBody">
An array of null-terminated strings, terminated by two null characters.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056923"> </a><p class="pCellBody">
REG_NONE
</p>
</td>
    <td><a name="wp1056925"> </a><p class="pCellBody">
No defined value type.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056927"> </a><p class="pCellBody">
REG_RESOURCE_LIST
</p>
</td>
    <td><a name="wp1056929"> </a><p class="pCellBody">
A device-driver resource list.
</p>
</td>
</tr>
  <tr align="left" valign="top">    <td><a name="wp1056931"> </a><p class="pCellBody">
REG_SZ
</p>
</td>
    <td><a name="wp1056933"> </a><p class="pCellBody">
A null-terminated string.  It will be a Unicode or ANSI string, depending on whether you use the Unicode or ANSI functions.
</p>
</td>
</tr>
</table>
</div>
<p class="pBody">
</p>
<a name="wp1037803"> </a><p class="pBody">
<b class="cBold">VALUE-DATA</b>   Variable parameter
</p>
<a name="wp1037804"> </a><p class="pBody">
Buffer to receive the data for the value entry. If you know what type of data is being returned, you may specify this parameter accordingly.  If the type of data returned is unknown, you may specify a group item structured as follows:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
01 VALUE-DATA<a name="wp1037805"> </a>
   02 VALUE-DATA-ORIG                                PIC X (n).<a name="wp1037806"> </a>
   02 VALUE-DWORD redefines VALUE-DATA-ORIG          Usage signed-long.<a name="wp1037807"> </a>
   02 VALUE-LIT-ENDIAN redefines VALUE-DATA-ORIG     Usage signed-long.<a name="wp1037809"> </a>
   02 VALUE-BIG-ENDIAN redefines VALUE-DATA-ORIG     S9 (9) COMP-4.<a name="wp1037810"> </a>
   02 VALUE-EXPAND-SZ redefines VALUE-DATA-ORIG      PIC X (n).<a name="wp1037811"> </a>
   02 VALUE-LINK redefines VALUE-DATA-ORIG           PIC X (n).<a name="wp1037812"> </a>
   02 VALUE-MULTI-SZ redefines VALUE-DATA-ORIG       PIC X (n).<a name="wp1037813"> </a>
   02 VALUE-NONE redefines VALUE-DATA-ORIG           PIC X (n).<a name="wp1037814"> </a>
   02 VALUE-RESOURCE-LIST redefines VALUE-DATA-ORIG  PIC X (n).<a name="wp1037815"> </a>
   02 VALUE-SZ redefines VALUE-DATA-ORIG             PIC X (n).<a name="wp1037817"> </a>
</pre></div>
<a name="wp1037818"> </a><p class="pBody">
<b class="cBold">DATA-SIZE</b>     Usage unsigned-long
</p>
<a name="wp1037819"> </a><p class="pBody">
Specifies the size, in bytes, of the VALUE-DATA buffer.  When the function returns, DATA-SIZE contains the number of bytes copied to VALUE-DATA.  This parameter can be NULL only if VALUE-DATA is NULL.
</p>
<a name="wp1037820"> </a><p class="pBody">
<b class="cBold">STATUS-CODE   </b>Numeric data item
</p>
<a name="wp1037821"> </a><p class="pBody">
Receives the return status of call to Microsoft's &quot;RegEnumValue&quot; function.  A return status of zero indicates success; non-zero indicates that an error occurred.  A value of `259' indicates that there are no more values for the specified key.
</p>
<a name="wp1037822"> </a><h3 class="pHeadingRef">
Comments
</h3>
<a name="wp1037823"> </a><p class="pBody">
To enumerate values, an application should initialize the NDX parameter to `1' and call REG_ENUM_VALUE repeatedly, incrementing NDX each time, until there are no more values (that is, until the function returns with STATUS-CODE set to `259').
</p>
<a name="wp1037824"> </a><p class="pBody">
While an application is using REG_ENUM_VALUE, it should not make calls to any registry routines that might change the values being queried.
</p>
<a name="wp1037825"> </a><p class="pBody">
The key identified by the OPEN-KEY-HANDLE parameter must have been opened with KEY_QUERY_VALUE access.
</p>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com subject=E-01-DS-060621-ACUCOBOL-GT-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
