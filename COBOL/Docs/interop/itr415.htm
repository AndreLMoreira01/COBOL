<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.6.1058" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/08/06 14:57:47" />
  <title>4.10  Distributing Applications Containing ActiveX Controls</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       A Guide to Interoperating with ACUCOBOL-GT <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="itr4.htm">Chapter 4: Using ActiveX Controls and COM Objects</a> &gt; </p>
<a name="wp1038056"> </a><h2 class="pHeading1">
4.10  Distributing Applications Containing ActiveX Controls
</h2>
<a name="wp1038058"> </a><p class="pBody">
To distribute your application, you need the object files and the resources they use.  If you have added ActiveX controls to your application, you need to distribute files associated with the ActiveX controls along with the bitmap, &quot;.wav&quot;, XFD, and configuration files required by your application.  In addition, you need to modify your installation program to install and register the controls on the end-user's machine.  Typically, you can accomplish this by copying the ActiveX control files (at least a &quot;.ocx&quot; or &quot;.dll&quot; file) to the directory where your application will be installed on the user's hard disk and calling the following command from your install shield script or batch file:
</p>
<div class="pPreformattedRelative"><pre class="pPreformattedRelative">
regsvr32 &lt;ocx or dll name&gt;<a name="wp1038060"> </a>
</pre></div>
<a name="wp1038062"> </a><p class="pBody">
The &quot;regsvr32.exe&quot; file is normally located in the user's \windows\system directory.  It is also included on the ACUCOBOL-GT Windows installation CD.  Do not assume that it is in the user's search path of that it is pre-installed on Windows 98 and Windows NT 4. 
</p>
<a name="wp1038063"> </a><p class="pNote">
<hr />
<b>Note:  </b>We recommend that you test your component installation by using the declaratives section to catch exceptions when creating an instance of an ActiveX control. See C$EXCEPINFO in Appendix I in <em class="cEmphasis">ACUCOBOL-GT Appendices </em>for details.  In addition, note that &quot;regsvr32<b class="cBold">&quot; </b>can be used to unregister a control as well as register it.  This may be useful if you want to test whether or not your installation script is properly registering the control.  When you type &quot;regsvr32&quot; with no command-line options, a list of available options is displayed.
<hr />
</p>
<a name="wp1038065"> </a><p class="pBody">
For your convenience, several Microsoft controls have been included with the ACUCOBOL-GT Windows runtime.  You can use these controls in your program and redistribute them to your end users as needed.  The runtime checks out the license key automatically so you don't have to provide one.  These controls include:
</p>
<a name="wp1038066"> </a><p class="pBody">
Microsoft Chart Control
</p>
<a name="wp1038067"> </a><p class="pBody">
Microsoft Comm Control
</p>
<a name="wp1038068"> </a><p class="pBody">
Microsoft DTPicker Control
</p>
<a name="wp1038069"> </a><p class="pBody">
Microsoft ImageCombo Control
</p>
<a name="wp1038070"> </a><p class="pBody">
Microsoft ImageList Control
</p>
<a name="wp1038071"> </a><p class="pBody">
Microsoft Internet Control
</p>
<a name="wp1038072"> </a><p class="pBody">
Microsoft ListView Control
</p>
<a name="wp1038073"> </a><p class="pBody">
Microsoft Mail Control (MapiSession, MapiMessage)
</p>
<a name="wp1038074"> </a><p class="pBody">
Microsoft MaskEdit Control
</p>
<a name="wp1038075"> </a><p class="pBody">
Microsoft Monthview Control
</p>
<a name="wp1038076"> </a><p class="pBody">
Microsoft Progressbar Control
</p>
<a name="wp1038077"> </a><p class="pBody">
Microsoft RichTextBox Control
</p>
<a name="wp1038078"> </a><p class="pBody">
Microsoft Slider Control
</p>
<a name="wp1038079"> </a><p class="pBody">
Microsoft Statusbar Control
</p>
<a name="wp1038080"> </a><p class="pBody">
Microsoft SystemInfo Control
</p>
<a name="wp1038081"> </a><p class="pBody">
Microsoft Tabstrip Control
</p>
<a name="wp1038082"> </a><p class="pBody">
Microsoft Toolbar Control
</p>
<a name="wp1038083"> </a><p class="pBody">
Microsoft TreeView Control
</p>
<a name="wp1038084"> </a><p class="pBody">
Microsoft UpDown Control
</p>
<a name="wp1038085"> </a><p class="pBody">
The &quot;.ocx&quot; files for these controls reside in the \ms\ocx subdirectory of the ACUCOBOL-GT installation CD for Windows.  There, you will find documents called &quot;list.txt&quot; and &quot;procedure.txt&quot;, which describe how to install and register the Microsoft components onto the target machine(s).  Note that for network installations, you must install the components on each workstation that will use the software (including thin client terminals).  It is not sufficient to install the components on the server.  For information on the controls themselves, refer to Microsoft's Controls Reference on <a  href="http://msdn.microsoft.com">msdn.microsoft.com</a>. 
</p>
<a name="wp1038087"> </a><p class="pBody">
Of course, you can use any ActiveX control in your ACUCOBOL-GT application, not just the ones that we provide on disk.  
</p>
<a name="wp1038088"> </a><p class="pBody">
Complex controls may have more complicated installation and registration procedures.  If this is the case, control vendors typically provide instructions on distributing their controls.  Look for instructions in the form of &quot;readme&quot; files or online help files in the directory where your control is stored.  You can also refer to a vendor's Web site for instructions.
</p>
<a name="wp1038089"> </a><p class="pBody">
When an ActiveX control requires a license, the distributor of the control provides a license key.  This license key is a text string.  To use a license with an ActiveX control, you set the value of the LICENSE-KEY property for the control to this license key, thereby embedding this license key in your COBOL program.  Note that an ActiveX control is often delivered with two keys-one for development and one for distribution.  If this is the case, the ActiveX vendor will notify you of this fact.
</p>
<a name="wp1038091"> </a><p class="pBody">
Once you've set the LICENSE-KEY property, when your COBOL program creates an instance of the control, the license key is passed to the ActiveX control for verification.  Please note that if the license key is WideChar (WCHAR) (Doublebyte) such as &quot;0x0067 0x01a2 0x00dd 0x0134 0x0167,&quot; you must take some additional steps to ensure that the license code is passed. If the control's license is missing or invalid, the following message displays:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
Class is not licensed for use.<a name="wp1038092"> </a>
COBOL error at xxxxx in xxxxx.<a name="wp1038093"> </a>
</pre></div>
<a name="wp1038094"> </a><p class="pBody">
Refer to section 5.3.2 of <em class="cEmphasis">ACUCOBOL-GT User Interface Programming</em> for more information on using the LICENSE-KEY property and passing WideChar keys.
</p>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060622-Interop-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
