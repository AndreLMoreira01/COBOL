<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.6.1058" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/08/06 14:57:47" />
  <title>4.19  ActiveX Examples</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       A Guide to Interoperating with ACUCOBOL-GT <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="itr4.htm">Chapter 4: Using ActiveX Controls and COM Objects</a> &gt; </p>
<a name="wp1038218"> </a><h2 class="pHeading1">
4.19  ActiveX Examples
</h2>
<a name="wp1038220"> </a><p class="pBody">
Use of the Windows Media Player control is demonstrated in an AcuBench sample project located in the Support area of the Acucorp Web site.  To download the project, open your Web browser and navigate to: www.acucorp.com/support/public/sample_programs/index.php.  Select the category &quot;Graphical User Interface Sample Programs&quot; from the drop down list, and click on &quot;Media_Player.zip&quot;.
</p>
<a name="wp1038224"> </a><p class="pBody">
Following is an excerpt of the COPY file generated by <b class="cBold">AXDEFGEN</b> for Microsoft's Calendar Control 8.0.  The COPY file includes object names so that the compiler can distinguish between two classes with the same name in different objects.  For example, you might want to create an &quot;Application of Word&quot; and an &quot;Application of Excel&quot; in the same COBOL program.  In the Calendar COPY file, the line &quot;OBJECT @MSACAL&quot; specifies the object name.
</p>
<div class="pPreformatted"><pre class="pPreformatted">
* CAL.DEF - ActiveX control definitions for MSACAL<a name="wp1038225"> </a>
* Generated: Tuesday, June 22, 1999<a name="wp1038226"> </a>
<a name="wp1038227"> </a>
<a name="wp1038228"> </a>
    OBJECT @MSACAL<a name="wp1038229"> </a>
<a name="wp1038230"> </a>
* Calendar control<a name="wp1038231"> </a>
<a name="wp1038232"> </a>
*** Primary Interface ***<a name="wp1038233"> </a>
<a name="wp1038234"> </a>
* Calendar<a name="wp1038235"> </a>
     CLASS @Calendar<a name="wp1038236"> </a>
         CLSID, 8E27C92B-1264-101C-8A2F-040224009C02<a name="wp1038237"> </a>
         NAME, &quot;Calendar&quot;<a name="wp1038238"> </a>
         PRIMARY-INTERFACE<a name="wp1038239"> </a>
         ACTIVE-X-CONTROL<a name="wp1038240"> </a>
         DEFAULT-INTERFACE, &quot;ICalendar&quot;<a name="wp1038241"> </a>
         DEFAULT-SOURCE, &quot;DCalendarEvents&quot;<a name="wp1038242"> </a>
* BackColor<a name="wp1038243"> </a>
         PROPERTY-GET, -501, @BackColor<a name="wp1038244"> </a>
                 RETURNING &quot;OLE_COLOR&quot;<a name="wp1038245"> </a>
* BackColor<a name="wp1038246"> </a>
         PROPERTY-PUT, -501, @BackColor,<a name="wp1038247"> </a>
             &quot;OLE_COLOR (Property Value)&quot;<a name="wp1038248"> </a>
* Day<a name="wp1038249"> </a>
         PROPERTY-GET, 17, @Day<a name="wp1038250"> </a>
                 RETURNING &quot;short&quot;<a name="wp1038251"> </a>
* Day<a name="wp1038252"> </a>
         PROPERTY-PUT, 17, @Day,<a name="wp1038253"> </a>
             &quot;short (Property Value)&quot;<a name="wp1038254"> </a>
* DayFont<a name="wp1038255"> </a>
         PROPERTY-GET, 1, @DayFont<a name="wp1038256"> </a>
                 RETURNING &quot;IFontDisp*&quot;<a name="wp1038257"> </a>
* DayFont<a name="wp1038258"> </a>
         PROPERTY-PUT, 1, @DayFont,<a name="wp1038259"> </a>
             &quot;IFontDisp* (Property Value)&quot;<a name="wp1038260"> </a>
* DayFontColor<a name="wp1038261"> </a>
         PROPERTY-GET, 2, @DayFontColor<a name="wp1038262"> </a>
                 RETURNING &quot;OLE_COLOR&quot;<a name="wp1038263"> </a>
* DayFontColor<a name="wp1038264"> </a>
         PROPERTY-PUT, 2, @DayFontColor,<a name="wp1038265"> </a>
             &quot;OLE_COLOR (Property Value)&quot;<a name="wp1038266"> </a>
* NextDay<a name="wp1038267"> </a>
         METHOD, 22, @NextDay<a name="wp1038268"> </a>
* NextMonth<a name="wp1038269"> </a>
         METHOD, 23, @NextMonth<a name="wp1038270"> </a>
* NextWeek<a name="wp1038271"> </a>
         METHOD, 24, @NextWeek<a name="wp1038272"> </a>
* NextYear<a name="wp1038273"> </a>
         METHOD, 25, @NextYear<a name="wp1038274"> </a>
* PreviousDay<a name="wp1038275"> </a>
         METHOD, 26, @PreviousDay<a name="wp1038276"> </a>
* PreviousMonth<a name="wp1038277"> </a>
         METHOD, 27, @PreviousMonth<a name="wp1038278"> </a>
* PreviousWeek<a name="wp1038279"> </a>
         METHOD, 28, @PreviousWeek<a name="wp1038280"> </a>
* PreviousYear<a name="wp1038281"> </a>
         METHOD, 29, @PreviousYear<a name="wp1038282"> </a>
* Refresh<a name="wp1038283"> </a>
         METHOD, -550, @Refresh<a name="wp1038284"> </a>
* Today<a name="wp1038285"> </a>
         METHOD, 30, @Today<a name="wp1038286"> </a>
* AboutBox<a name="wp1038287"> </a>
         METHOD, -552, @AboutBox<a name="wp1038288"> </a>
* Click<a name="wp1038289"> </a>
         EVENT, -600, @CalendarClick<a name="wp1038290"> </a>
*            No Parameters<a name="wp1038291"> </a>
* DblClick<a name="wp1038292"> </a>
         EVENT, -601, @CalendarDblClick<a name="wp1038293"> </a>
*            No Parameters<a name="wp1038294"> </a>
* KeyDown<a name="wp1038295"> </a>
         EVENT, -602, @CalendarKeyDown<a name="wp1038296"> </a>
*            2 Parameters<a name="wp1038297"> </a>
                 short* KeyCode<a name="wp1038298"> </a>
                 short Shift<a name="wp1038299"> </a>
* KeyPress<a name="wp1038300"> </a>
         EVENT, -603, @CalendarKeyPress<a name="wp1038301"> </a>
*            1 Parameter<a name="wp1038302"> </a>
*                short* KeyAscii<a name="wp1038303"> </a>
* KeyUp<a name="wp1038304"> </a>
         EVENT, -604, @CalendarKeyUp<a name="wp1038305"> </a>
*            2 Parameters<a name="wp1038306"> </a>
*                short* KeyCode<a name="wp1038307"> </a>
*                short Shift<a name="wp1038308"> </a>
* BeforeUpdate<a name="wp1038309"> </a>
         EVENT, 2, @CalendarBeforeUpdate<a name="wp1038310"> </a>
*            1 Parameter<a name="wp1038311"> </a>
*                short* Cancel<a name="wp1038312"> </a>
* AfterUpdate<a name="wp1038313"> </a>
         EVENT, 1, @CalendarAfterUpdate<a name="wp1038314"> </a>
*            No Parameters<a name="wp1038315"> </a>
* NewMonth<a name="wp1038316"> </a>
         EVENT, 3, @CalendarNewMonth<a name="wp1038317"> </a>
*            No Parameters<a name="wp1038318"> </a>
* NewYear<a name="wp1038319"> </a>
         EVENT, 4, @CalendarNewYear<a name="wp1038320"> </a>
*            No Parameters<a name="wp1038321"> </a>
</pre></div>
<a name="wp1038322"> </a><p class="pBody">
After generating the COPY file, you may create and use a Calendar control.  You can add the control to your Screen Section as described in <a  href="itr43.htm#wp1037506">section 4.2</a>, or you can use the DISPLAY statement in the Procedure DivisioN to create the control.  Note that the following two statements are equivalent:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
    DISPLAY Calendar HANDLE IN my-cal.<a name="wp1038326"> </a>
    DISPLAY Calendar OF MSACAL HANDLE IN my-cal.<a name="wp1038327"> </a>
</pre></div>
<a name="wp1038328"> </a><p class="pBody">
Here is an example of how you might update your Procedure Division to create, and then modify, the control:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
* Declare the calendar control&#39;s handle.<a name="wp1038329"> </a>
77 CALENDAR-1 USAGE IS HANDLE OF Calendar.<a name="wp1038330"> </a>
...<a name="wp1038331"> </a>
* Declare the @KeyPress event parameter<a name="wp1038332"> </a>
77 KEY-ASCII PIC X USAGE COMP-X.<a name="wp1038333"> </a>
77 KEY-CHAR PIC X REDEFINES KEY-ASCII.<a name="wp1038334"> </a>
...<a name="wp1038335"> </a>
* Calendar @Value is the current date<a name="wp1038336"> </a>
01 DATE-1<a name="wp1038337"> </a>
    03 MONTH PIC 99.<a name="wp1038338"> </a>
    03 FILLER PIC X VALUE &#39;/&#39;.<a name="wp1038339"> </a>
    03 DAY PIC 99.<a name="wp1038340"> </a>
    03 FILLER PIC X VALUE &#39;/&#39;.<a name="wp1038341"> </a>
    03 YEAR PIC 9999.<a name="wp1038342"> </a>
...<a name="wp1038343"> </a>
* Create an instance of the calendar control<a name="wp1038344"> </a>
       DISPLAY Calendar LINE 4 COLUMN 6 LINES 10 SIZE 40<a name="wp1038345"> </a>
               EVENT PROCEDURE IS CALENDAR-EVENT-HANDLER<a name="wp1038346"> </a>
               HANDLE IN CALENDAR-1.<a name="wp1038347"> </a>
...<a name="wp1038348"> </a>
* Set the calendar&#39;s &quot;day&quot; font to Courier 10 pt Bold<a name="wp1038349"> </a>
       USE CALENDAR-1 DayFont<a name="wp1038350"> </a>
           MODIFY Name = &quot;Courier&quot; Size = 10 Bold = 1.<a name="wp1038351"> </a>
...<a name="wp1038352"> </a>
* Set the calendar's year to 2000<a name="wp1038353"> </a>
       MODIFY CALENDAR-1 Year = 2000.<a name="wp1038354"> </a>
...<a name="wp1038355"> </a>
* Invoke the NextDay method<a name="wp1038356"> </a>
       MODIFY CALENDAR-1 NextDay.<a name="wp1038357"> </a>
...<a name="wp1038358"> </a>
* Invoke the PreviousDay method<a name="wp1038359"> </a>
       MODIFY CALENDAR-1 PreviousDay.<a name="wp1038360"> </a>
...<a name="wp1038361"> </a>
* Handle events<a name="wp1038362"> </a>
...<a name="wp1038363"> </a>
CALENDAR-EVENT-HANDLER.<a name="wp1038364"> </a>
       EVALUATE EVENT-TYPE<a name="wp1038365"> </a>
           WHEN MSG-AX-EVENT<a name="wp1038366"> </a>
               EVALUATE EVENT-DATA-2<a name="wp1038367"> </a>
                   WHEN CalendarBeforeUpdate<a name="wp1038368"> </a>
* Don&#39;t allow years &gt;= 2000<a name="wp1038369"> </a>
                       INQUIRE EVENT-CONTROL-HANDLE <a name="wp1038370"> </a>
                          @Value IN DATE-1<a name="wp1038371"> </a>
                       IF YEAR OF DATE-1 &gt;= 2000<a name="wp1038372"> </a>
* Cancel the update (set the &#39;Cancel&#39; parameter to 1)<a name="wp1038373"> </a>
                           CALL &quot;C$SETEVENTDATA&quot; USING<a name="wp1038374"> </a>
                           EVENT-CONTROL-HANDLE, 1<a name="wp1038375"> </a>
                       END-IF<a name="wp1038376"> </a>
                   WHEN CalendarKeyPress<a name="wp1038377"> </a>
* Stop run if the user presses &#39;X&#39;<a name="wp1038378"> </a>
                       CALL &quot;C$GETEVENTDATA&quot; USING <a name="wp1038379"> </a>
                       EVENT-CONTROL-HANDLE, KEY-ASCII<a name="wp1038380"> </a>
                   IF KEY-CHAR = &#39;X&#39; STOP RUN END-IF<a name="wp1038381"> </a>
...<a name="wp1038382"> </a>
</pre></div>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060622-Interop-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
