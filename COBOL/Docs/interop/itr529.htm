<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.6.1058" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/08/06 14:58:17" />
  <title>5.5.2  NETDEFGEN Utility Reference</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       A Guide to Interoperating with ACUCOBOL-GT <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="itr5.htm">Chapter 5: Working With .NET Assemblies</a> &gt; <a href="itr522.htm">5.5  Calling .NET from COBOL </a> &gt; </p>
<a name="wp1038796"> </a><h2 class="pHeading2">
5.5.2  NETDEFGEN Utility Reference
</h2>
<a name="wp1038798"> </a><p class="pBody">
The <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> utility is a dialog-based application designed to facilitate the consumption of .NET assemblies from Windows-based ACUCOBOL-GT programs.  The role of <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> is to locate the names of .NET assemblies on the user's machine and generate a COBOL COPY file for the selected assembly.  
</p>
<a name="wp1038799"> </a><p class="pBody">
The COPY file is used by the ACUCOBOL-GT compiler for syntax and parameter type checking as well as efficient code generation.  For instructions on how to use <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> and what to do with the COPY file once it is generated, refer to <a  href="itr523.htm#wp1038528">section 5.5.1</a>.
</p>
<a name="wp1038803"> </a><p class="pNote">
<hr />
<b>Note:  </b>If you want to include a .NET assembly in your COBOL application, you must first acquire it and install it on the development machine.  If you have downloaded the control off the Internet, you may need to license it for distribution.  See &quot;<a  href="itr527.htm#wp1038779">.NET control distribution and licensing</a>&quot; for more information.
<hr />
</p>
<a name="wp1038807"> </a><p class="pBody">
The &quot;netdefgen.exe&quot; file is located in the \AcuGT\bin directory wherever you installed ACUCOBOL-GT (\acucorp\acucbl700\AcuGT\bin by default).  It is accessible from the Windows Start menu.  When you run <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span>, a dialog box is displayed.
</p>
<a name="wp1038811"> </a><p class="pBodyRelative">
</p><div><img src="images/itr5a3.gif" height="580" width="556" border="0" hspace="0" vspace="0"/>
</div><p class="pBodyRelative">
</p>
<a name="wp1038813"> </a><p class="pBody">
The <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> dialog box includes a list box labeled &quot;Cached Assemblies.&quot;  This box lists all assemblies located in the computer's .NET GAC.  .NET assemblies are made up of<em style="font-style: normal" class="cEmphasis"> </em>classes within a NameSpace.  Classes are a way of defining objects in the .NET world.  Within a NameSpace class hierarchy are methods, properties, enumerations, and events.  When you select an assembly from the Cached Assemblies list, a list of classes appears in the list box labeled &quot;NameSpace Classes.&quot;  This allows you to select specifically the classes in the assembly that interest you. To select multiple classes, hold down the &quot;Ctrl&quot; key while clicking.
</p>
<a name="wp1038814"> </a><p class="pBody">
If you do not make a selection, the resulting COPY file contains definitions for all NameSpaces and classes found in the assembly.  Assemblies can contain many NameSpaces and classes resulting in very large COPY files.  
</p>
<a name="wp1038815"> </a><p class="pBody">
If the assembly of interest is not listed in the Cached Assemblies list (i.e., if it is not in the .NET GAC), you can use the entry field labeled &quot;Input Assembly Path&quot; to specify where the assembly resides.  If you manually type the input path, click the <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">Show NameSpaces For Input Assembly</span> button to view the NameSpaces for the assembly.
</p>
<a name="wp1038816"> </a><p class="pBody">
If you use the <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">Search</span> button to locate the desired assembly, NameSpaces are automatically displayed.    
</p>
<a name="wp1038817"> </a><p class="pBody">
Use the <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">Clear NameSpace Selection</span> button to clear a selection from the NameSpace Classes list.  
</p>
<a name="wp1038818"> </a><p class="pBody">
In the &quot;Output Copyfile Path&quot; field, enter the filename and path where you want the COPY file to be stored or click the Search button to navigate to the desired directory.  If any event handlers are generated for the class that you selected, they are also saved in this directory with a name of the format &quot;Namespace.Class.dll&quot;. 
</p>
<a name="wp1038819"> </a><p class="pBody">
Click the Help button any time to view online help for the <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> utility.
</p>
<a name="wp1038820"> </a><p class="pBody">
Click <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">Execute</span> to generate a COBOL COPY file from the contents of the chosen assembly. 
</p>
<a name="wp1038821"> </a><p class="pBody">
<span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> interrogates the assembly and produces an English translation for NameSpaces, classes, methods, enumerations, properties, and events that the ACUCOBOL-GT compiler understands.  At run time, the COBOL program accesses the assembly using a NameSpace and class from the COPY file.  
</p>
<a name="wp1038822"> </a><p class="pBody">
The resultant COPY file is included in a COBOL program for use by the compiler and programmer.  In addition to the COPY file, <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal">NETDEFGEN</span> generates event handlers for each class in the assembly.  This is native MSIL code that listens for .NET assembly events, routes them to the ACUCOBOL-GT runtime, which in turn delivers events to the COBOL program.  Event handlers are loaded by the runtime when the COBOL program executes a DISPLAY or CREATE statement or has a reference to an assembly in a Screen Section.  The runtime locates event handlers from a configuration file called &quot;NetEvents.ini&quot;.  This file contains a list of directory paths indicating where to search for event handlers.  &quot;NetEvents.ini&quot; must be located in the same directory as the runtime.  If &quot;NetEvents.ini&quot; is not present, the runtime attempts to load event handlers from the folder where the runtime is located.  
</p>
<a name="wp1038823"> </a><p class="pBody">
Windows base types-such as integer, unsigned integer, float, double, byte, character, and character string-are supported.  However, .NET objects as parameters are not supported.  Any method or constructor requiring parameter object creation by the COBOL program fails. 
</p>
<a name="wp1038824"> </a><p class="pBody">
An optional &quot;NetCopyFile.ini&quot; contains XML parameters.  They are for debugging and should not be changed unless requested by Acucorp.  &quot;NetCopyFile.ini&quot; contents are as follows:
</p>
<div class="pPreformatted"><pre class="pPreformatted">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; <a name="wp1038825"> </a>
&lt;Settings&gt; <a name="wp1038826"> </a>
     &lt;EventSource&gt;yes&lt;/EventSource&gt; <a name="wp1038827"> </a>
     &lt;Debug&gt;no&lt;/Debug&gt; <a name="wp1038828"> </a>
&lt;/Settings&gt;<a name="wp1038829"> </a>
</pre></div>
<a name="wp1038830"> </a><p class="pBody">
EventSource (yes, no; default is no) produces the event MSIL source code on disk with an EVT type as the filename suffix.  Debug (yes, no; default is no) produces a debug version of the generated event handler. 
</p>
<a name="wp1043074"> </a><h5 class="pHeading4">
More:
</h5>
<div class="pSmartList1"><ul class="pSmartList1">
<a name="wp1043078"> </a><div class="pSmartList1"><li><a  href="itr530.htm#wp1038862">NETDEFGEN COPY files</a></li></div>
<a name="wp1043082"> </a><div class="pSmartList1"><li><a  href="itr532.htm#wp1039053">NETDEFGEN methods</a></li></div>
<a name="wp1043086"> </a><div class="pSmartList1"><li><a  href="itr533.htm#wp1039066">NETDEFGEN properties</a></li></div>
<a name="wp1043090"> </a><div class="pSmartList1"><li><a  href="itr534.htm#wp1039078">NETDEFGEN events</a></li></div>
<a name="wp1043094"> </a><div class="pSmartList1"><li><a  href="itr535.htm#wp1039088">NETDEFGEN enumerators</a></li></div>
<a name="wp1043098"> </a><div class="pSmartList1"><li><a  href="itr536.htm#wp1039098">Sample COPY file</a></li></div>
<a name="wp1043102"> </a><div class="pSmartList1"><li><a  href="itr537.htm#wp1039261">Sample controls</a></li></div>
</ul></div>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060622-Interop-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
