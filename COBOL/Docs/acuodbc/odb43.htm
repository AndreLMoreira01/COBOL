<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="Acucorp WWH" />
  <meta name="LASTUPDATED" content="06/15/06 11:28:36" />
  <title>4.1.1  Accessing Data From Word 97 and 2000</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

    <a href="../docs.htm" target="acudoc"><img src="images/sbooks.gif" width="70" height="27" border="0" alt="Books" align="right" /></a>
    <span style="font-size: 18px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       AcuODBC User's Guide <br />
    </font></span>
    <span style="font-size: 14px ; font-weight: bold"><font face="Arial, Helvetica, sans-serif">
       Version 7.2
     </font></span>

 <p />

 <blockquote>
<p class="breadcrumb"><a href="odb4.htm">Chapter 4: Working With Windows Applications</a> &gt; <a href="odb42.htm">4.1 Working With Windows Applications</a> &gt; </p>
<a name="wp1028256"> </a><h2 class="pHeading2">
4.1.1  Accessing Data From Word 97 and 2000
</h2>
<a name="wp1028259"> </a><p class="pBody">
The following procedure describes how to access your COBOL data from Microsoft Word 97 and Word 2000, the word processing component of Microsoft Office 97 and Office 2000, respectively.  If you have a different version of Word, use the procedures shown here to get an idea of the concepts involved in accessing COBOL data from within a Word document, but be aware that your steps may be slightly different.
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp1028260"> </a><div class="pSmartList1"><li>Start Microsoft Word and open the document into which you want to insert data.</li></div>
<a name="wp1034742"> </a><div class="pSmartList1"><li>Select <b class="cBold">Mail Merge</b> from the Tools menu.  If your MS Office menus are set to &quot;Show recently used commands first,&quot; you may need to click on the expansion arrows at the bottom of the Tools menu to see the Mail Merge option.<br />
<img src="images/tools_me.gif" height="343" width="431" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028264"> </a><p class="pIndented1">
The Mail Merge Helper dialog box appears.
</p>
<a name="wp1028265"> </a><div class="pSmartList1"><li>Under &quot;Main Document,&quot; click <b class="cBold">Create</b> and select <b class="cBold">Form Letters</b>.<br />
<img src="images/mm_creat.gif" height="434" width="487" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028268"> </a><div class="pSmartList1"><li>Because you are already working in the document into which you want to insert data, click <b class="cBold">Active Window</b>.<br />
<img src="images/active_w.gif" height="139" width="562" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1034753"> </a><p class="pIndented1">
You are then returned to the Mail Merge Helper dialog box
</p>
<a name="wp1028270"> </a><div class="pSmartList1"><li>Under &quot;Data Source,&quot; click <b class="cBold">Get Data</b>, and select <b class="cBold">Open Data Source</b>.<br />
<img src="images/mm_opend.gif" height="429" width="487" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028272"> </a><div class="pSmartList1"><li>Click <b class="cBold">MS Query</b> in the Open Data Source dialog box.  (If you do not have an MS Query button, you will need to install MS Query on your machine.)</li></div>
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1035297"> </a><div class="pSmartList2"><li>In Word 2000, the MS Query button appears to the right of the &quot;File name&quot; text box.<br />
<img src="images/open_dat.gif" height="409" width="637" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1035393"> </a><div class="pSmartList2"><li>In Word 97, the MS Query button appears under the Cancel button on the right-hand side of the screen.<br />
<img src="images/w97_open.gif" height="366" width="637" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
</ul></div>
<a name="wp1028274"> </a><p class="pIndented1">
This starts MS Query, and opens the Choose Data Source dialog box.  If you want to use MS Query's &quot;Query Wizard&quot; to create your SQL query, leave the &quot;Use Query Wizard&quot; check box selected.  Refer to MS Query's online documentation for instructions on using the Query Wizard.  
</p>
<a name="wp1028275"> </a><p class="pIndented1">
For simplicity, clear the Query Wizard.
</p>
<a name="wp1028276"> </a><div class="pSmartList1"><li>Select the DSN that corresponds to the data source you want to access and click <b class="cBold">OK</b>.  (Refer to <a  href="odb32.htm#wp1051131">section 3.1, &quot;Data Source Names (DSNs),&quot;</a> for instructions on creating DSNs.)  If you want to use the sample DSN that comes with AcuODBC, select <b class="cBold">AcuODBC Datasource</b>.<br />
<img src="images/choose_d.gif" height="255" width="503" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1035413"> </a><p class="pIndented1">
If you do not see your DSN listed, do one of the following:
</p>
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1035420"> </a><div class="pSmartList2"><li>Click <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: bold">Browse</span> and navigate to &quot;c:\Program Files\Common Files\ odbc\DataSources&quot;, then double-click on the name of your DSN.  This adds the DSN to the list in the Databases area of the Choose Data Source dialog box.</li></div>
<a name="wp1035424"> </a><div class="pSmartList2"><li>Click <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: bold">Options</span> and enter the path to the directory containing your DSN, then click <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: bold">Add</span>.  Now the contents of that directory will be listed in the Choose Data Source dialog box.  For more information, see the MS Query documentation.</li></div>
</ul></div>
<a name="wp1028278"> </a><div class="pSmartList1"><li>Select the table or tables that you want to add (for example, &quot;clients&quot;), and then click <b class="cBold">Add</b>.  Close the box when you're done. <br />
<img src="images/word_add.gif" height="274" width="353" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028280"> </a><p class="pIndented1">
For each table you selected, a list box is displayed on the MS Query screen.  This box lists all of the columns in the associated table.
</p>
<a name="wp1028281"> </a><div class="pSmartList1"><li>Double-click each column that you want to read into your Word document, and that column appears on the screen. If you want to add all columns, double-click the &quot;*&quot; at the top of the list box.  <br />
<img src="images/query1.gif" height="399" width="580" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028283"> </a><p class="pIndented1">
If you prefer, you can populate the table by clicking the SQL button and entering and executing an SQL query.
</p>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp1032935"> </a><div class="pSmartList2"><li>To enter an SQL statement, click <b class="cBold">SQL</b>.  </li></div>
<a name="wp1028284"> </a><div class="pSmartList2"><li>In the SQL dialog box, type the SQL command you want to execute.  Click <b class="cBold">OK</b> when you're done.  (For a description of the SQL commands supported by AcuODBC, refer to <a  href="odb56.htm#wp1028311">section 5.3, &quot;SQL Syntax Supported by AcuODBC.&quot;</a>)<br />
<img src="images/sql_comm.gif" height="226" width="524" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1035793"> </a><p style="font-family: Arial, Verdana, Helvetica, sans-serif">
<hr />
<b>Note:  </b>If you click SQL to enter a query before, or rather than, performing Step&#160;10, the dialog box opens with an empty entry field.  If you click SQL after performing Step 10, the box opens with a query that reflects the selections you have already made.
<hr />
</p>
</ol></div>
<a name="wp1028288"> </a><div class="pSmartList1"><li>Select <b class="cBold">Return Data to Microsoft Word</b> from the MS Query File menu.  You are returned to your Word document.</li></div>
<a name="wp1028289"> </a><div class="pSmartList1"><li>Click <span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: bold">Edit Main Document</span> to continue preparing your document.  Notice that new mail merge buttons are added to the toolbar.</li></div>
<a name="wp1028290"> </a><div class="pSmartList1"><li>Place the cursor in your document where you want to insert the data.  Click <b class="cBold">Insert Merge Field</b> to see a drop-down list of table columns.  These are the columns that you selected in MS Query.<br />
<img src="images/choose_m.gif" height="249" width="210" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028292"> </a><div class="pSmartList1"><li>Select the merge field you wish to insert.  The control characters for this field are placed in your document. <br />
<img src="images/insertme.gif" height="405" width="449" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028294"> </a><div class="pSmartList1"><li>To display the data that corresponds to each field code, click the <b style="font-weight: bold" class="cBold">&lt;&lt;ABC&gt;&gt;</b><span style="font-family: Arial, Verdana, Helvetica, sans-serif; font-weight: normal"> button on the Mail Merge toolbar</span>.  Use the control buttons on the Mail Merge toolbar to scroll between records.<br />
<img src="images/abc_butt.gif" height="415" width="299" border="0" hspace="0" vspace="0"/>
<br />
</li></div>
<a name="wp1028296"> </a><div class="pSmartList1"><li>Finish your document as you normally would.  Whenever you want to insert a COBOL data field, click <b class="cBold">Insert Merge Field</b> once again and select the appropriate field.  </li></div>
<a name="wp1034804"> </a><p class="pIndented1">
Use the directional buttons on the Mail Merge tool bar to move to the next, previous, first, or last record in the table.  
</p>
</ol></div>
<a name="wp1028297"> </a><p class="pBody">
For more instructions on using Word's mail merge feature, refer to your Microsoft documentation.
</p>
 </blockquote>

 <hr />

 <table align="left" border="0" cellspacing="0" cellpadding="0">
   <tr>
     <td align="left" width="300">
       <span style="font-size: 12px ; font-weight: bold ; font-family: Arial, Helvetica, sans-serif">
         <a href="http://www.acucorp.com">Acucorp, Inc.</a><br />
       </span>
       <span style="font-size: 10px ; font-family: Arial, Helvetica, sans-serif">
         Voice: 800.262.6585 (U.S.A. and Canada)<br />
         Voice: 858.689.4500<br />
         Fax: 858.689.4550<br />
         Please share your comments on this manual<br />
         or on any Acucorp documentation with the<br />
         <a href="mailto:docfeedback@acucorp.com?subject=E-01-UG-060621-AcuODBC-7.2">Acucorp Communications Department</a>.<br />
       </span>
     </td>
   </tr>
 </table>

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 
</body>
</html>
